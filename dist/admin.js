const{useState,useEffect,useRef}=React,CLOUDINARY_CLOUD_NAME="diwxfpt92",CLOUDINARY_UPLOAD_PRESET="ktm_unsigned",API_BASE="";function LoginPage({onLogin:y,error:m}){const[D,j]=useState(""),[T,d]=useState(""),[b,C]=useState(!1),[E,p]=useState(!1);return React.createElement("div",{className:"login-page"},React.createElement("div",{className:"login-box"},React.createElement("div",{className:"text-center mb-4"},React.createElement("i",{className:"fas fa-tractor fa-3x text-warning mb-3"}),React.createElement("h4",{className:"text-dark"},"KTM Admin"),React.createElement("p",{className:"text-muted small"},"\u0110\u0103ng nh\u1EADp \u0111\u1EC3 qu\u1EA3n l\xFD")),m&&React.createElement("div",{className:"alert alert-danger py-2 small"},React.createElement("i",{className:"fas fa-exclamation-circle me-2"}),m),React.createElement("form",{onSubmit:async q=>{q.preventDefault(),C(!0),await y(D,T),C(!1)}},React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label small"},"T\xEAn \u0111\u0103ng nh\u1EADp"),React.createElement("div",{className:"input-group"},React.createElement("span",{className:"input-group-text"},React.createElement("i",{className:"fas fa-user"})),React.createElement("input",{type:"text",className:"form-control",value:D,onChange:q=>j(q.target.value),placeholder:"admin",required:!0,autoFocus:!0}))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"form-label small"},"M\u1EADt kh\u1EA9u"),React.createElement("div",{className:"input-group"},React.createElement("span",{className:"input-group-text"},React.createElement("i",{className:"fas fa-lock"})),React.createElement("input",{type:E?"text":"password",className:"form-control",value:T,onChange:q=>d(q.target.value),placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",required:!0}),React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>p(!E)},React.createElement("i",{className:`fas fa-eye${E?"-slash":""}`})))),React.createElement("button",{type:"submit",className:"btn btn-warning w-100",disabled:b},b?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang \u0111\u0103ng nh\u1EADp..."):React.createElement(React.Fragment,null,React.createElement("i",{className:"fas fa-sign-in-alt me-2"}),"\u0110\u0103ng nh\u1EADp"))),React.createElement("div",{className:"text-center mt-4"},React.createElement("a",{href:"/",className:"text-muted small text-decoration-none"},React.createElement("i",{className:"fas fa-arrow-left me-1"}),"V\u1EC1 trang ch\u1EE7"))))}function Toast({message:y,type:m,onClose:D}){return useEffect(()=>{const j=setTimeout(D,3e3);return()=>clearTimeout(j)},[]),React.createElement("div",{className:`toast show align-items-center text-white bg-${m} border-0`,role:"alert"},React.createElement("div",{className:"d-flex"},React.createElement("div",{className:"toast-body"},y),React.createElement("button",{type:"button",className:"btn-close btn-close-white me-2 m-auto",onClick:D})))}function Loading({show:y}){return y?React.createElement("div",{className:"loading-overlay"},React.createElement("div",{className:"spinner-border text-warning",style:{width:"3rem",height:"3rem"}},React.createElement("span",{className:"visually-hidden"},"\u0110ang t\u1EA3i..."))):null}function Sidebar({activeMenu:y,onMenuChange:m,onLogout:D,currentUser:j}){return React.createElement("div",{className:"sidebar d-none d-md-block"},React.createElement("div",{className:"logo"},React.createElement("i",{className:"fas fa-tractor me-2"})," KTM Admin"),React.createElement("nav",{className:"nav flex-column mt-3"},[{id:"search",icon:"fa-search",label:"Tra c\u1EE9u nhanh",highlight:!0},{id:"albums",icon:"fa-images",label:"Qu\u1EA3n l\xFD Album"},{id:"videos",icon:"fa-video",label:"Qu\u1EA3n l\xFD Video"},{id:"products",icon:"fa-box",label:"S\u1EA3n ph\u1EA9m"},{id:"orders",icon:"fa-receipt",label:"Qu\u1EA3n l\xFD \u0111\u01A1n h\xE0ng"},{id:"stats",icon:"fa-chart-column",label:"Th\u1ED1ng k\xEA"},{id:"settings",icon:"fa-cog",label:"C\xE0i \u0111\u1EB7t",disabled:!0}].map(d=>React.createElement("a",{key:d.id,href:"#",className:`nav-link ${y===d.id?"active":""} ${d.disabled?"opacity-50":""} ${d.highlight?"text-warning":""}`,onClick:b=>{b.preventDefault(),d.disabled||m(d.id)}},React.createElement("i",{className:`fas ${d.icon}`})," ",d.label,d.disabled&&React.createElement("span",{className:"badge bg-secondary ms-2"},"Soon"),d.highlight&&React.createElement("span",{className:"badge bg-warning text-dark ms-2"},"HOT")))),React.createElement("div",{className:"position-absolute bottom-0 w-100 p-3 border-top border-secondary"},React.createElement("div",{className:"d-flex justify-content-between align-items-center"},React.createElement("a",{href:"/",className:"text-white-50 text-decoration-none small"},React.createElement("i",{className:"fas fa-home me-1"})," Trang ch\u1EE7"),D&&React.createElement("button",{className:"btn btn-sm btn-outline-danger",onClick:D,title:"\u0110\u0103ng xu\u1EA5t"},React.createElement("i",{className:"fas fa-sign-out-alt"})))))}function AlbumList({albums:y,onSelect:m,onCreate:D,onEdit:j,onDelete:T,loading:d,currentFolder:b,onBack:C,breadcrumb:E}){return React.createElement("div",null,React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3"},React.createElement("div",{className:"d-flex align-items-center"},b&&React.createElement("button",{className:"btn btn-outline-secondary me-3",onClick:C},React.createElement("i",{className:"fas fa-arrow-left"})),React.createElement("h4",{className:"m-0"},React.createElement("i",{className:"fas fa-folder me-2 text-warning"}),b?b.title:"Th\u01B0 vi\u1EC7n \u1EA3nh")),React.createElement("button",{className:"btn btn-warning",onClick:D},React.createElement("i",{className:"fas fa-folder-plus me-1"}),"T\u1EA1o Folder")),E&&E.length>0&&React.createElement("nav",{"aria-label":"breadcrumb",className:"mb-3"},React.createElement("ol",{className:"breadcrumb mb-0"},React.createElement("li",{className:"breadcrumb-item"},React.createElement("a",{href:"#",onClick:p=>{p.preventDefault(),C("root")},className:"text-warning"},React.createElement("i",{className:"fas fa-home"}))),E.map((p,V)=>React.createElement("li",{key:p.id,className:`breadcrumb-item ${V===E.length-1?"active":""}`},V===E.length-1?p.title:React.createElement("a",{href:"#",onClick:q=>{q.preventDefault(),C(p)},className:"text-warning"},p.title))))),d?React.createElement("div",{className:"text-center py-5"},React.createElement("div",{className:"spinner-border text-warning"})):y.length===0?React.createElement("div",{className:"text-center py-5"},React.createElement("i",{className:"fas fa-folder-open fa-3x text-muted mb-3"}),React.createElement("p",{className:"text-muted"},b?"Folder n\xE0y \u0111ang tr\u1ED1ng":"Ch\u01B0a c\xF3 folder n\xE0o. H\xE3y t\u1EA1o folder \u0111\u1EA7u ti\xEAn!")):React.createElement("div",{className:"row g-3"},y.map(p=>React.createElement("div",{key:p.uuid||p.id,className:"col-6 col-md-4 col-lg-3"},React.createElement("div",{className:"card album-card h-100",onClick:()=>m(p)},p.cover?React.createElement("img",{src:p.cover,className:"album-cover",alt:p.title}):React.createElement("div",{className:"card-body text-center py-4"},React.createElement("i",{className:"fas fa-folder fa-3x text-warning mb-2"})),React.createElement("div",{className:"card-body"},React.createElement("h6",{className:"card-title mb-1"},p.title),React.createElement("small",{className:"text-muted"},p.subfolderCount>0&&React.createElement("span",null,React.createElement("i",{className:"fas fa-folder me-1"}),p.subfolderCount),p.subfolderCount>0&&p.count>0&&" \u2022 ",p.count>0&&React.createElement("span",null,React.createElement("i",{className:"fas fa-image me-1"}),p.count),p.subfolderCount===0&&p.count===0&&"Tr\u1ED1ng")),React.createElement("div",{className:"card-footer bg-transparent border-0 pt-0"},React.createElement("button",{className:"btn btn-sm btn-outline-primary me-2",onClick:V=>{V.stopPropagation(),j(p)},title:"S\u1EEDa album"},React.createElement("i",{className:"fas fa-edit"})),React.createElement("button",{className:"btn btn-sm btn-outline-danger",onClick:V=>{V.stopPropagation(),T(p)},title:"X\xF3a album"},React.createElement("i",{className:"fas fa-trash"}))))))))}function AlbumModal({show:y,album:m,onClose:D,onSave:j,parentId:T}){const[d,b]=useState({slug:"",title:"",description:"",cover_url:"",parent_id:null}),[C,E]=useState(!1),[p,V]=useState(!1),q=useRef(null);useEffect(()=>{b(m?{slug:m.id||"",title:m.title||"",description:m.description||"",cover_url:m.cover||"",parent_id:m.parentId||null}:{slug:"",title:"",description:"",cover_url:"",parent_id:T||null})},[m,y,T]);const I=async A=>{A.preventDefault(),E(!0),await j(d),E(!1)},L=A=>A.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[đĐ]/g,"d").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),H=async A=>{const R=A.type==="image/heic"||A.type==="image/heif"||/\.heic$/i.test(A.name);if(A.size<=2097152&&!R)return A;try{const Z=await createImageBitmap(A),J=document.createElement("canvas");let f=Z.width,O=Z.height;const X=800;return(f>X||O>X)&&(f>O?(O=Math.round(O/f*X),f=X):(f=Math.round(f/O*X),O=X)),J.width=f,J.height=O,J.getContext("2d").drawImage(Z,0,0,f,O),Z.close(),new Promise((te,P)=>{J.toBlob(Y=>{Y?te(new File([Y],A.name.replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg"})):P(new Error("Kh\xF4ng n\xE9n \u0111\u01B0\u1EE3c \u1EA3nh"))},"image/jpeg",.8)})}catch(Z){throw console.error("Compress cover error:",Z),new Error("Kh\xF4ng th\u1EC3 x\u1EED l\xFD \u1EA3nh. Th\u1EED ch\u1ECDn \u1EA3nh kh\xE1c.")}},F=async A=>{var Z;const $=A.target.files[0];if(!$)return;if(!($.type.startsWith("image/")||/\.(jpg|jpeg|png|gif|webp|heic|heif)$/i.test($.name))){alert("Vui l\xF2ng ch\u1ECDn file \u1EA3nh!");return}V(!0);try{const J=await H($),f=new FormData;f.append("file",J),f.append("upload_preset",CLOUDINARY_UPLOAD_PRESET),f.append("folder","ktm-albums/covers");const O=await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`,{method:"POST",body:f}),X=await O.json();if(!O.ok)throw console.error("Cloudinary error:",X),new Error(((Z=X.error)==null?void 0:Z.message)||"Upload failed");b(N=>({...N,cover_url:X.secure_url}))}catch(J){console.error("Cover upload error:",J),alert("L\u1ED7i upload \u1EA3nh b\xECa: "+J.message)}V(!1),A.target.value=""};return y?React.createElement("div",{className:"modal show d-block",style:{background:"rgba(0,0,0,0.5)"}},React.createElement("div",{className:"modal-dialog modal-dialog-centered"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("h5",{className:"modal-title"},m?"S\u1EEDa":"T\u1EA1o"," Folder"),React.createElement("button",{type:"button",className:"btn-close",onClick:D})),React.createElement("form",{onSubmit:I},React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"T\xEAn Folder *"),React.createElement("input",{type:"text",className:"form-control",value:d.title,onChange:A=>b({...d,title:A.target.value,slug:d.slug||L(A.target.value)}),required:!0})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"Slug (URL) *"),React.createElement("input",{type:"text",className:"form-control",value:d.slug,onChange:A=>b({...d,slug:A.target.value}),required:!0,disabled:!!m}),React.createElement("small",{className:"text-muted"},"VD: may-cay-kubota-l1501")),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"M\xF4 t\u1EA3"),React.createElement("textarea",{className:"form-control",rows:"2",value:d.description,onChange:A=>b({...d,description:A.target.value})})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"\u1EA2nh b\xECa"),React.createElement("div",{className:"d-flex gap-2 align-items-start"},d.cover_url&&React.createElement("div",{className:"position-relative",style:{width:80,height:80}},React.createElement("img",{src:d.cover_url,alt:"Cover",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:8}}),React.createElement("button",{type:"button",className:"btn btn-sm btn-danger position-absolute",style:{top:-8,right:-8,padding:"2px 6px",fontSize:10},onClick:()=>b(A=>({...A,cover_url:""}))},React.createElement("i",{className:"fas fa-times"}))),React.createElement("div",{className:"flex-grow-1"},React.createElement("input",{ref:q,type:"file",accept:"image/*",className:"d-none",onChange:F}),React.createElement("button",{type:"button",className:"btn btn-outline-secondary w-100 mb-2",onClick:()=>{var A;return(A=q.current)==null?void 0:A.click()},disabled:p},p?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang upload..."):React.createElement(React.Fragment,null,React.createElement("i",{className:"fas fa-upload me-2"}),"Upload \u1EA3nh b\xECa")),React.createElement("input",{type:"url",className:"form-control form-control-sm",value:d.cover_url,onChange:A=>b({...d,cover_url:A.target.value}),placeholder:"Ho\u1EB7c d\xE1n URL \u1EA3nh..."}))))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"button",className:"btn btn-secondary",onClick:D},"H\u1EE7y"),React.createElement("button",{type:"submit",className:"btn btn-warning",disabled:C||p},C?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang l\u01B0u..."):"L\u01B0u")))))):null}function FolderTreeItem({folder:y,allAlbums:m,currentAlbumId:D,targetAlbum:j,onSelect:T,level:d=0}){const[b,C]=useState(!0),E=y.uuid||y.id,p=E===D,V=j===E,q=m.filter(L=>L.parentId===E),I=q.length>0;return React.createElement("div",{style:{marginLeft:d*16+"px"}},React.createElement("div",{className:`d-flex align-items-center p-2 rounded mb-1 ${V?"bg-info text-white":p?"bg-light text-muted":"hover-bg"}`,style:{cursor:p?"not-allowed":"pointer",opacity:p?.5:1,transition:"background 0.2s"},onClick:()=>!p&&T(E)},I&&React.createElement("i",{className:`fas fa-chevron-${b?"down":"right"} me-2`,style:{fontSize:"10px",width:"12px",cursor:"pointer"},onClick:L=>{L.stopPropagation(),C(!b)}}),!I&&React.createElement("span",{style:{width:"20px"}}),React.createElement("i",{className:`fas fa-folder${V?"-open":""} me-2 ${V?"":"text-warning"}`}),React.createElement("span",{className:"small"},y.title),p&&React.createElement("span",{className:"ms-2 badge bg-secondary",style:{fontSize:"9px"}},"Hi\u1EC7n t\u1EA1i"),y.count>0&&!p&&React.createElement("span",{className:"ms-auto badge bg-light text-muted",style:{fontSize:"10px"}},y.count)),b&&I&&React.createElement("div",null,q.map(L=>React.createElement(FolderTreeItem,{key:L.uuid||L.id,folder:L,allAlbums:m,currentAlbumId:D,targetAlbum:j,onSelect:T,level:d+1}))))}function AlbumDetail({album:y,onBack:m,onRefresh:D,showToast:j,onNavigateToFolder:T,onEditSubfolder:d,parentAlbum:b}){const[C,E]=useState([]),[p,V]=useState([]),[q,I]=useState(!0),[L,H]=useState(!1),[F,A]=useState(""),[$,R]=useState([]),[Z,J]=useState([]),[f,O]=useState({}),[X,N]=useState(null),[te,P]=useState(!1),[Y,ye]=useState(""),[ee,ae]=useState(!1),re=useRef(null),W=useRef(null),[he,ue]=useState(!1),[U,ge]=useState([]),[_e,oe]=useState([]),[ve,je]=useState(""),[t,n]=useState(!1),_=async(o,x=2)=>{const z=x*1024*1024,me=o.type==="image/heic"||o.type==="image/heif"||/\.heic$/i.test(o.name);if(o.size<=z&&!me)return o;try{const a=await createImageBitmap(o),l=document.createElement("canvas");let i=a.width,s=a.height;const u=1200;return(i>u||s>u)&&(i>s?(s=Math.round(s/i*u),i=u):(i=Math.round(i/s*u),s=u)),l.width=i,l.height=s,l.getContext("2d").drawImage(a,0,0,i,s),a.close(),new Promise((r,c)=>{l.toBlob(g=>{g?r(new File([g],o.name.replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg"})):c(new Error("Kh\xF4ng n\xE9n \u0111\u01B0\u1EE3c \u1EA3nh"))},"image/jpeg",.7)})}catch(a){throw console.error("Compress error:",a),new Error("Kh\xF4ng th\u1EC3 x\u1EED l\xFD \u1EA3nh")}};useEffect(()=>{B(),ce()},[y.id,y.uuid]);const B=async()=>{I(!0);try{const x=await(await fetch(`${API_BASE}/api/albums/${y.uuid||y.id}`)).json();E(x.images||[]);const me=await(await fetch(`${API_BASE}/api/albums?parent_id=${y.uuid||y.id}`)).json();V(Array.isArray(me)?me:[])}catch(o){console.error(o),j("L\u1ED7i t\u1EA3i d\u1EEF li\u1EC7u","danger")}I(!1)},ce=async()=>{try{const x=await(await fetch(`${API_BASE}/api/albums`)).json();oe(Array.isArray(x)?x:[])}catch(o){console.error("Error loading albums:",o)}},$e=o=>{ge(x=>x.includes(o)?x.filter(z=>z!==o):[...x,o])},we=async()=>{if(!ve||U.length===0){j("Vui l\xF2ng ch\u1ECDn folder \u0111\xEDch","warning");return}n(!0);let o=0;for(const x of U)try{(await fetch(`${API_BASE}/api/images/${x}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({album_id:ve})})).ok&&o++}catch(z){console.error("Move error:",z)}n(!1),ue(!1),ge([]),je(""),o>0?(j("\u0110\xE3 di chuy\u1EC3n \u1EA3nh th\xE0nh c\xF4ng!","success"),B(),D()):j("Di chuy\u1EC3n th\u1EA5t b\u1EA1i","danger")},[Ce,Ee]=useState(!1),M=async()=>{if(U.length===0||!confirm(`X\xF3a ${U.length} \u1EA3nh \u0111\xE3 ch\u1ECDn? H\xE0nh \u0111\u1ED9ng n\xE0y kh\xF4ng th\u1EC3 ho\xE0n t\xE1c!`))return;Ee(!0);let o=0;for(const x of U)try{(await fetch(`${API_BASE}/api/images/${x}`,{method:"DELETE"})).ok&&o++}catch(z){console.error("Delete error:",z)}Ee(!1),ge([]),o>0?(j(`\u0110\xE3 x\xF3a ${o} \u1EA3nh!`,"success"),B(),D()):j("X\xF3a th\u1EA5t b\u1EA1i","danger")},de=()=>{U.length===C.length?ge([]):ge(C.map(o=>o.id))},Oe=async()=>{if(Y.trim()){ae(!0);try{const o=Y.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[đĐ]/g,"d").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");if(!(await fetch(`${API_BASE}/api/albums`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:o+"-"+Date.now(),title:Y,parent_id:y.uuid||y.id})})).ok)throw new Error("L\u1ED7i t\u1EA1o folder");j("T\u1EA1o folder th\xE0nh c\xF4ng!","success"),ye(""),P(!1),B(),D()}catch(o){j(o.message,"danger")}ae(!1)}},se=async o=>{if(confirm(`X\xF3a folder "${o.title}"? T\u1EA5t c\u1EA3 n\u1ED9i dung b\xEAn trong s\u1EBD b\u1ECB x\xF3a!`))try{await fetch(`${API_BASE}/api/albums/${o.uuid||o.id}`,{method:"DELETE"}),j("\u0110\xE3 x\xF3a folder","success"),B(),D()}catch(x){j("L\u1ED7i x\xF3a folder","danger")}},h=o=>{const x=Array.from(o).filter(z=>z.type.startsWith("image/")||/\.(jpg|jpeg|png|gif|webp|heic|heif)$/i.test(z.name));R(z=>[...z,...x]),x.forEach(z=>{const me=new FileReader;me.onload=a=>{J(l=>[...l,{file:z,preview:a.target.result}])},me.readAsDataURL(z)})},le=o=>{R(x=>x.filter((z,me)=>me!==o)),J(x=>x.filter((z,me)=>me!==o))},pe=async o=>{var me;const x=new FormData;x.append("file",o),x.append("upload_preset",CLOUDINARY_UPLOAD_PRESET),x.append("folder",`ktm-albums/${y.id}`);const z=await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`,{method:"POST",body:x});if(!z.ok){const a=await z.json();throw console.error("Cloudinary error:",a),new Error(((me=a.error)==null?void 0:me.message)||"Upload failed")}return await z.json()},be=async()=>{if($.length===0)return;H(!0);let o=0;for(let x=0;x<$.length;x++)try{A(`\u0110ang x\u1EED l\xFD ${x+1}/${$.length}...`);const z=await _($[x],2);A(`\u0110ang upload ${x+1}/${$.length}...`);const me=await pe(z);await fetch(`${API_BASE}/api/albums/${y.id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:me.secure_url,caption:f[x]||$[x].name.replace(/\.[^/.]+$/,""),sort_order:C.length+x})}),o++}catch(z){console.error("Upload error:",z)}H(!1),A(""),R([]),J([]),O({}),o>0?(j(`\u0110\xE3 upload ${o} \u1EA3nh th\xE0nh c\xF4ng!`,"success"),B(),D()):j("Upload th\u1EA5t b\u1EA1i","danger")},ke=async(o,x)=>{if(confirm("X\xF3a \u1EA3nh n\xE0y?"))try{await fetch(`${API_BASE}/api/images/${o}`,{method:"DELETE"}),j("\u0110\xE3 x\xF3a \u1EA3nh","success"),B(),D()}catch(z){j("L\u1ED7i x\xF3a \u1EA3nh","danger")}},fe=o=>{var x;o.preventDefault(),(x=W.current)==null||x.classList.add("dragover")},Se=()=>{var o;(o=W.current)==null||o.classList.remove("dragover")},Ae=o=>{var x;o.preventDefault(),(x=W.current)==null||x.classList.remove("dragover"),h(o.dataTransfer.files)};return React.createElement("div",null,React.createElement("div",{className:"d-flex align-items-center justify-content-between mb-4"},React.createElement("div",{className:"d-flex align-items-center"},React.createElement("button",{className:"btn btn-outline-secondary me-3",onClick:m},React.createElement("i",{className:"fas fa-arrow-left"})),React.createElement("div",null,React.createElement("h4",{className:"m-0"},y.title),React.createElement("small",{className:"text-muted"},p.length>0&&React.createElement("span",null,p.length," folder \u2022 "),C.length," \u1EA3nh"))),React.createElement("button",{className:"btn btn-outline-warning btn-sm",onClick:()=>P(!0)},React.createElement("i",{className:"fas fa-folder-plus me-1"}),"T\u1EA1o Folder con")),te&&React.createElement("div",{className:"card mb-4 border-warning"},React.createElement("div",{className:"card-body"},React.createElement("h6",{className:"mb-3"},React.createElement("i",{className:"fas fa-folder-plus me-2 text-warning"}),"T\u1EA1o folder con"),React.createElement("div",{className:"d-flex gap-2"},React.createElement("input",{type:"text",className:"form-control",placeholder:"T\xEAn folder...",value:Y,onChange:o=>ye(o.target.value),onKeyPress:o=>o.key==="Enter"&&Oe(),autoFocus:!0}),React.createElement("button",{className:"btn btn-warning",onClick:Oe,disabled:ee||!Y.trim()},ee?React.createElement("span",{className:"spinner-border spinner-border-sm"}):"T\u1EA1o"),React.createElement("button",{className:"btn btn-secondary",onClick:()=>{P(!1),ye("")}},"H\u1EE7y")))),p.length>0&&React.createElement("div",{className:"card mb-4"},React.createElement("div",{className:"card-body"},React.createElement("h6",{className:"mb-3"},React.createElement("i",{className:"fas fa-folder me-2 text-warning"}),"Folder con"),React.createElement("div",{className:"row g-2"},p.map(o=>React.createElement("div",{key:o.uuid||o.id,className:"col-6 col-md-4 col-lg-3"},React.createElement("div",{className:"card h-100 folder-item",style:{cursor:"pointer"},onClick:()=>T&&T(o)},React.createElement("div",{className:"card-body text-center py-3"},React.createElement("i",{className:"fas fa-folder fa-2x text-warning mb-2"}),React.createElement("div",{className:"small fw-bold text-truncate"},o.title),React.createElement("small",{className:"text-muted"},o.subfolderCount>0&&React.createElement("span",null,o.subfolderCount," folder"),o.subfolderCount>0&&o.count>0&&" \u2022 ",o.count>0&&React.createElement("span",null,o.count," \u1EA3nh"),o.subfolderCount===0&&o.count===0&&"Tr\u1ED1ng")),React.createElement("div",{className:"card-footer bg-transparent border-0 pt-0 text-center"},React.createElement("button",{className:"btn btn-sm btn-outline-primary me-1",onClick:x=>{x.stopPropagation(),d&&d(o)},title:"S\u1EEDa folder"},React.createElement("i",{className:"fas fa-edit"})),React.createElement("button",{className:"btn btn-sm btn-outline-danger",onClick:x=>{x.stopPropagation(),se(o)},title:"X\xF3a folder"},React.createElement("i",{className:"fas fa-trash"}))))))))),React.createElement("div",{className:"card mb-4"},React.createElement("div",{className:"card-body"},React.createElement("h6",{className:"mb-3"},React.createElement("i",{className:"fas fa-cloud-upload-alt me-2"}),"Upload \u1EA3nh m\u1EDBi"),React.createElement("div",{ref:W,className:"upload-zone",onClick:()=>{var o;return(o=re.current)==null?void 0:o.click()},onDragOver:fe,onDragLeave:Se,onDrop:Ae},React.createElement("i",{className:"fas fa-images fa-2x text-muted mb-2"}),React.createElement("p",{className:"mb-0"},"K\xE9o th\u1EA3 \u1EA3nh v\xE0o \u0111\xE2y ho\u1EB7c click \u0111\u1EC3 ch\u1ECDn"),React.createElement("small",{className:"text-muted"},"H\u1ED7 tr\u1EE3 JPG, PNG, WebP"),React.createElement("input",{ref:re,type:"file",multiple:!0,accept:"image/*",onChange:o=>h(o.target.files)})),Z.length>0&&React.createElement("div",{className:"mt-3"},React.createElement("div",{className:"upload-preview"},Z.map((o,x)=>React.createElement("div",{key:x,className:"upload-preview-item"},React.createElement("img",{src:o.preview,alt:""}),React.createElement("button",{className:"remove",onClick:()=>le(x)},React.createElement("i",{className:"fas fa-times"}))))),React.createElement("div",{className:"mt-3"},React.createElement("button",{className:"btn btn-warning",onClick:be,disabled:L},L?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),F||"\u0110ang upload..."):React.createElement(React.Fragment,null,React.createElement("i",{className:"fas fa-upload me-2"}),"Upload ",$.length," \u1EA3nh")))))),React.createElement("div",{className:"card"},React.createElement("div",{className:"card-body"},React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2"},React.createElement("div",{className:"d-flex align-items-center gap-2"},React.createElement("h6",{className:"m-0"},React.createElement("i",{className:"fas fa-th me-2"}),"\u1EA2nh (",C.length,")"),C.length>0&&React.createElement("button",{className:"btn btn-sm btn-outline-secondary",onClick:de},U.length===C.length?"B\u1ECF ch\u1ECDn":"Ch\u1ECDn t\u1EA5t c\u1EA3")),U.length>0&&React.createElement("div",{className:"d-flex align-items-center gap-2 flex-wrap"},React.createElement("span",{className:"badge bg-primary"},U.length," \u0111\xE3 ch\u1ECDn"),React.createElement("button",{className:"btn btn-sm btn-info",onClick:()=>ue(!0)},React.createElement("i",{className:"fas fa-folder-open me-1"}),"Di chuy\u1EC3n"),React.createElement("button",{className:"btn btn-sm btn-danger",onClick:M,disabled:Ce},Ce?React.createElement("span",{className:"spinner-border spinner-border-sm"}):React.createElement(React.Fragment,null,React.createElement("i",{className:"fas fa-trash me-1"}),"X\xF3a")),React.createElement("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>ge([])},React.createElement("i",{className:"fas fa-times"})))),q?React.createElement("div",{className:"text-center py-4"},React.createElement("div",{className:"spinner-border text-warning"})):C.length===0?React.createElement("div",{className:"text-center py-4 text-muted"},React.createElement("i",{className:"fas fa-image fa-2x mb-2"}),React.createElement("p",null,"Ch\u01B0a c\xF3 \u1EA3nh n\xE0o trong album n\xE0y")):React.createElement("div",{className:"image-grid"},C.map((o,x)=>React.createElement("div",{key:x,className:`image-item ${U.includes(o.id)?"selected":""}`,style:{position:"relative",cursor:"pointer"},onClick:()=>$e(o.id)},React.createElement("div",{className:"select-checkbox",style:{position:"absolute",top:"6px",left:"6px",zIndex:10,width:"24px",height:"24px",borderRadius:"4px",background:U.includes(o.id)?"#0d6efd":"rgba(255,255,255,0.9)",border:U.includes(o.id)?"none":"2px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"}},U.includes(o.id)&&React.createElement("i",{className:"fas fa-check",style:{color:"#fff",fontSize:"12px"}})),React.createElement("img",{src:o.src,alt:o.caption,style:{opacity:U.includes(o.id)?.7:1,border:U.includes(o.id)?"3px solid #0d6efd":"none",borderRadius:"8px"}}),React.createElement("div",{className:"actions"},React.createElement("button",{className:"btn btn-sm btn-danger",onClick:z=>{z.stopPropagation(),ke(o.id,x)},title:"X\xF3a \u1EA3nh"},React.createElement("i",{className:"fas fa-trash"}))),o.caption&&React.createElement("div",{className:"p-2 bg-light small text-truncate"},o.caption)))))),he&&React.createElement("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"}},React.createElement("div",{className:"modal-dialog modal-dialog-centered"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header bg-info text-white"},React.createElement("h5",{className:"modal-title"},React.createElement("i",{className:"fas fa-folder-open me-2"}),"Di chuy\u1EC3n ",U.length," \u1EA3nh"),React.createElement("button",{type:"button",className:"btn-close btn-close-white",onClick:()=>ue(!1)})),React.createElement("div",{className:"modal-body",style:{maxHeight:"400px",overflowY:"auto"}},React.createElement("p",{className:"text-muted small mb-3"},"Ch\u1ECDn th\u01B0 m\u1EE5c \u0111\xEDch:"),React.createElement("div",{className:"folder-tree"},_e.filter(o=>!o.parentId).map(o=>React.createElement(FolderTreeItem,{key:o.uuid||o.id,folder:o,allAlbums:_e,currentAlbumId:y.uuid||y.id,targetAlbum:ve,onSelect:je})))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>ue(!1)},"H\u1EE7y"),React.createElement("button",{type:"button",className:"btn btn-info",onClick:we,disabled:!ve||t},t?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-1"}),"\u0110ang chuy\u1EC3n..."):React.createElement(React.Fragment,null,React.createElement("i",{className:"fas fa-check me-1"}),"Di chuy\u1EC3n \u0111\u1EBFn \u0111\xE2y")))))),X&&React.createElement("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.9)"},onClick:()=>N(null)},React.createElement("div",{className:"modal-dialog modal-fullscreen d-flex align-items-center justify-content-center"},React.createElement("div",{className:"position-relative",style:{maxWidth:"95vw",maxHeight:"95vh"}},React.createElement("button",{className:"btn btn-light position-absolute",style:{top:"-50px",right:"0",borderRadius:"50%",width:"40px",height:"40px"},onClick:()=>N(null)},React.createElement("i",{className:"fas fa-times"})),React.createElement("img",{src:X.src,alt:X.caption,style:{maxWidth:"95vw",maxHeight:"90vh",objectFit:"contain"},onClick:o=>o.stopPropagation()}),X.caption&&React.createElement("div",{className:"text-white text-center mt-2"},X.caption)))))}function SearchCenter({showToast:y,onNavigate:m}){const[D,j]=useState(""),[T,d]=useState([]),[b,C]=useState([]),[E,p]=useState([]),[V,q]=useState("all"),[I,L]=useState(null),[H,F]=useState("list"),[A,$]=useState(!0),[R,Z]=useState([]),[J,f]=useState([]),O=useRef(null),[X,N]=useState(!0),[te,P]=useState(!1),Y=useRef(null),[ye,ee]=useState(!1),[ae,re]=useState([{role:"assistant",content:`Xin ch\xE0o! H\xE3y h\u1ECFi t\xF4i v\u1EC1 s\u1EA3n ph\u1EA9m, gi\xE1 c\u1EA3... V\xED d\u1EE5:
\u2022 "Gi\xE1 van 2 tay?"
\u2022 "Combo r\u1EBB nh\u1EA5t?"
\u2022 "Freeship?"`,attachments:[]}]),[W,he]=useState(""),[ue,U]=useState(!1),ge=useRef(null),_e=useRef(null),[oe,ve]=useState(null),[je,t]=useState(!1),[n,_]=useState(null),[B,ce]=useState(!1),[$e,we]=useState(!1),[Ce,Ee]=useState(null),[M,de]=useState({name:"",code:"",price:"",image:"",category:"",note:""}),Oe=["Ty xy lanh","Combo Van 1 tay","Combo Van 2 tay","Combo Van 3 tay","Combo Van 4 tay","Combo Van 5 tay","Trang g\u1EA1t","Ph\u1EE5 ki\u1EC7n","Van \u0111i\u1EC1u khi\u1EC3n"],se=e=>{e._type==="product"&&(_(e),de({name:e.name||"",code:e.code||"",price:e.price||"",image:e.image||"",category:e.category||"",note:e.note||""}),t(!0))},h=async()=>{if(n)try{if(!(await fetch(`${API_BASE}/api/products?id=${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok)throw new Error("L\u1ED7i c\u1EADp nh\u1EADt");y("C\u1EADp nh\u1EADt th\xE0nh c\xF4ng!","success"),t(!1),_(null),fe()}catch(e){y(e.message,"danger")}},le=async e=>{const r=e._type==="product"?"s\u1EA3n ph\u1EA9m":e._type==="album"?"\u1EA3nh":"video";if(confirm(`X\xF3a ${r} "${e.name}"?`))try{let c="";if(e._type==="product"?c=`${API_BASE}/api/products?id=${e.id}`:e._type==="album"?c=`${API_BASE}/api/images/${e.id}`:e._type==="video"&&(c=`${API_BASE}/api/videos/${e.id}`),!(await fetch(c,{method:"DELETE"})).ok)throw new Error("L\u1ED7i x\xF3a");y(`\u0110\xE3 x\xF3a ${r}`,"success"),fe()}catch(c){y(c.message,"danger")}},pe=async e=>{try{const r=Ce?`${API_BASE}/api/products?id=${Ce.id}`:`${API_BASE}/api/products`;if(!(await fetch(r,{method:Ce?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("L\u1ED7i l\u01B0u s\u1EA3n ph\u1EA9m");y(Ce?"C\u1EADp nh\u1EADt th\xE0nh c\xF4ng!":"Th\xEAm s\u1EA3n ph\u1EA9m th\xE0nh c\xF4ng!","success"),we(!1),Ee(null),fe()}catch(r){y(r.message,"danger")}},be="ktm_admin_data_cache_v1",ke=1e3*60*10,fe=async()=>{let e=null,r=!1;try{const c=localStorage.getItem(be);if(c){const g=JSON.parse(c);g&&g.timestamp&&Date.now()-g.timestamp<ke&&Array.isArray(g.data)?(e=g.data,console.log("[CACHE] Using cache, items:",e.length),C(e),d(e),$(!1),r=!0):console.log("[CACHE] Cache expired or invalid")}else console.log("[CACHE] No cache found")}catch(c){console.error("[CACHE] Error parsing cache:",c)}r||$(!0);try{const[c,g,w]=await Promise.all([fetch(`${API_BASE}/api/products`),fetch(`${API_BASE}/api/albums`),fetch(`${API_BASE}/api/video-folders?withVideos=true`)]),[S,v,k]=await Promise.all([c.ok?c.json():[],g.ok?g.json():[],w.ok?w.json():[]]),K=Array.isArray(S)?S.map(Pe=>({...Pe,_type:"product",_source:"database"})):[];Z(v);let ne=[];if(Array.isArray(v)&&v.length>0){const Pe=v.map(xe=>fetch(`${API_BASE}/api/albums/${xe.id}`)),Ve=await Promise.all(Pe);(await Promise.all(Ve.map(xe=>xe.ok?xe.json():{}))).forEach((xe,Ue)=>{const He=v[Ue];xe.images&&xe.images.length>0&&xe.images.forEach(qe=>{ne.push({id:qe.id,name:qe.caption||"\u1EA2nh t\u1EEB "+He.title,image:qe.src,folder:He.title,_type:"album",_source:"database"})})})}f(k);let ie=[];Array.isArray(k)&&k.forEach(Pe=>{Pe.videos&&Pe.videos.forEach(Ve=>{ie.push({id:Ve.id,name:Ve.title,folder:Pe.name,image:Ve.thumb,youtubeId:Ve.youtubeId,url:Ve.url,_type:"video",_source:"database"})})});const Q=[...K,...ne,...ie];if(!e||JSON.stringify(Q)!==JSON.stringify(e)){C(Q),d(Q);try{localStorage.setItem(be,JSON.stringify({data:Q,timestamp:Date.now()}))}catch(Pe){}}}catch(c){console.error("Song song fetch error:",c)}$(!1)};useEffect(()=>{fe(),setTimeout(()=>{var e;return(e=O.current)==null?void 0:e.focus()},100)},[]);const Se=async(e,r)=>{if(!(!X||r.length===0)){P(!0);try{const c=r.map(w=>({id:w.id,name:w.name,price:w.price,category:w.category,note:w.note,folder:w.folder,_type:w._type})),g=await fetch(`${API_BASE}/api/ai-search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,products:c})});if(g.ok){const w=await g.json();if(w.matchedIds&&w.matchedIds.length>0){const S=r.filter(v=>w.matchedIds.includes(v.id));S.length>0&&d(S)}else w.matchedIds&&w.matchedIds.length===0&&d([])}}catch(c){console.error("AI Search error:",c)}P(!1)}},Ae=e=>{if(j(e),Y.current&&clearTimeout(Y.current),!e.trim()){o(V);return}const c=e.toLowerCase().split(/\s+/).filter(S=>S.length>0),g=b.filter(S=>{const v=Object.entries(S).filter(([k])=>!k.startsWith("_")).map(([,k])=>String(k||"").toLowerCase()).join(" ");return c.some(k=>v.includes(k))});let w=g;V!=="all"&&(w=g.filter(S=>(S.category||S._type)===V)),d(w),X&&e.length>=3&&(Y.current=setTimeout(()=>{Se(e,w)},500))},o=e=>{q(e);let r=b;if(e!=="all"&&(r=b.filter(c=>(c.category||c._type)===e)),D.trim()){const g=D.toLowerCase().split(/\s+/).filter(w=>w.length>0);r=r.filter(w=>{const S=Object.entries(w).filter(([v])=>!v.startsWith("_")).map(([,v])=>String(v||"").toLowerCase()).join(" ");return g.every(v=>S.includes(v))})}d(r)},x=(e,r)=>{navigator.clipboard.writeText(e).then(()=>{L(r),y("\u0110\xE3 copy!","success"),setTimeout(()=>L(null),1500)})},z=async(e,r)=>{try{const g=await(await fetch(e)).blob();await navigator.clipboard.write([new ClipboardItem({[g.type]:g})]),L(r+"-img"),y("\u0110\xE3 copy \u1EA3nh!","success"),setTimeout(()=>L(null),1500)}catch(c){x(e,r+"-img")}},me=e=>{let r=e.toLowerCase();const c=[],g=b.filter(v=>v._type==="product");if(r.includes("ty")||r.includes("xy lanh")){if(r.includes("gi\u1EEFa")||r.includes("giua")){const v=g.find(k=>{var K;return(K=k.name)==null?void 0:K.toLowerCase().includes("xy lanh gi\u1EEFa")});v&&!c.find(k=>k.id===v.id)&&c.push(v)}if(r.includes("nghi\xEAng")||r.includes("nghieng")){const v=g.find(k=>{var K;return(K=k.name)==null?void 0:K.toLowerCase().includes("xy lanh nghi\xEAng")});v&&!c.find(k=>k.id===v.id)&&c.push(v)}if(r.includes("\u1EE7i")||r.includes("ui")){const v=g.find(k=>{var K;return(K=k.name)==null?void 0:K.toLowerCase().includes("xy lanh \u1EE7i")});v&&!c.find(k=>k.id===v.id)&&c.push(v)}}const w=r.match(/van\s*(\d+)\s*tay.*?(\d+)\s*ty/);if(w){const v=w[1],k=w[2],K=g.find(ne=>{var Q;const ie=((Q=ne.name)==null?void 0:Q.toLowerCase())||"";return ie.includes("combo")&&ie.includes(`${v} tay`)&&(ie.includes(`${k} xy`)||ie.includes(`${k} xylanh`))});if(K&&!c.find(ne=>ne.id===K.id))c.push(K);else{const ne=g.find(ie=>{var Ne;const Q=((Ne=ie.name)==null?void 0:Ne.toLowerCase())||"";return Q.includes("combo")&&Q.includes(`${v} tay`)});ne&&!c.find(ie=>ie.id===ne.id)&&c.push(ne)}}if(r.includes("combo")&&!w){const v=r.match(/combo.*?(\d+)\s*tay/);if(v){const k=v[1];g.filter(ne=>{var Q;const ie=((Q=ne.name)==null?void 0:Q.toLowerCase())||"";return ie.includes("combo")&&ie.includes(`${k} tay`)}).forEach(ne=>{c.find(ie=>ie.id===ne.id)||c.push(ne)})}}const S=r.match(/van\s*(\d+)\s*tay/);if(S&&!r.includes("ty")&&!r.includes("combo")){const v=S[1],k=g.find(K=>{var ie;const ne=((ie=K.name)==null?void 0:ie.toLowerCase())||"";return ne.includes(`van ${v} tay`)&&!ne.includes("combo")});k&&!c.find(K=>K.id===k.id)&&c.push(k)}return c.slice(0,4)},a=async e=>{if(!e.trim())return;const r={role:"user",content:e,attachments:[]};re(g=>[...g,r]),he(""),U(!0);const c=me(e);setTimeout(()=>{var g;return(g=ge.current)==null?void 0:g.scrollIntoView({behavior:"smooth"})},100);try{const w=b.filter(Q=>Q._type==="product").map(Q=>{let Ne=`- ${Q.name}`;return Q.code&&(Ne+=` (M\xE3: ${Q.code})`),Q.price&&(Ne+=` - Gi\xE1: ${Q.price.replace(/[đ\s]/g,"")}\u0111`),Q.category&&(Ne+=` [${Q.category}]`),Q.note&&(Ne+=` (${Q.note})`),Ne}).join(`
`),v=ae.slice(-6).map(Q=>`${Q.role==="user"?"Kh\xE1ch":"AI"}: ${Q.content}`).join(`
`),k=v?`L\u1ECACH S\u1EEC H\u1ED8I THO\u1EA0I:
${v}

DANH S\xC1CH S\u1EA2N PH\u1EA8M:
${w}`:w,K=await fetch(`${API_BASE}/api/ai-chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,context:k,audience:"admin"})}),ne=await K.json();if(!K.ok)throw new Error(ne.error||"API error");const ie=ne.response||"Xin l\u1ED7i, t\xF4i kh\xF4ng th\u1EC3 tr\u1EA3 l\u1EDDi l\xFAc n\xE0y.";re(Q=>[...Q,{role:"assistant",content:ie,attachments:c}])}catch(g){console.error("AI Error:",g);const w=e.toLowerCase(),S=b.filter(k=>{const K=Object.values(k).join(" ").toLowerCase();return w.split(" ").some(ne=>K.includes(ne))});let v="";S.length>0?(v=`T\xECm th\u1EA5y ${S.length} s\u1EA3n ph\u1EA9m li\xEAn quan:

`,S.slice(0,5).forEach(k=>{v+=`\u2022 ${k.name}`,k.price&&(v+=` - ${k.price.replace(/[đ\s]/g,"")}\u0111`),k.note&&(v+=` (${k.note})`),v+=`
`}),S.length>5&&(v+=`
...v\xE0 ${S.length-5} s\u1EA3n ph\u1EA9m kh\xE1c`)):v='Kh\xF4ng t\xECm th\u1EA5y s\u1EA3n ph\u1EA9m ph\xF9 h\u1EE3p. H\xE3y th\u1EED t\u1EEB kh\xF3a kh\xE1c nh\u01B0 "van", "combo", "xy lanh"...',re(k=>[...k,{role:"assistant",content:v,attachments:S.slice(0,4)}])}U(!1),setTimeout(()=>{var g,w;(g=ge.current)==null||g.scrollIntoView({behavior:"smooth"}),(w=_e.current)==null||w.focus()},100)};function l({show:e,product:r,categories:c,onClose:g,onSave:w}){const[S,v]=useState({name:"",code:"",price:"",image:"",category:"",note:"",sort_order:0}),[k,K]=useState(!1),[ne,ie]=useState(!1),Q=useRef(null),Ne=G=>{const Le=G.replace(/[^\d]/g,"");return Le?Le.replace(/\B(?=(\d{3})+(?!\d))/g,".")+"\u0111":""};useEffect(()=>{if(r)if(v({name:r.name||"",code:r.code||"",price:r.price||"",image:r.image||"",category:r.category||"",note:r.note||"",sort_order:r.sort_order||0}),r.price){const G=r.price.replace(/[^\d]/g,"");xe(G),v(Le=>({...Le,price:Ne(G)}))}else xe("");else v({name:"",code:"",price:"",image:"",category:"",note:"",sort_order:0}),xe("")},[r,e]);const[Pe,Ve]=React.useState(""),[ze,xe]=React.useState(""),Ue=G=>{const Fe=G.target.value.replace(/[^\d]/g,"");if(!Fe){v({...S,price:""}),xe("");return}if(Fe===ze&&Fe.length>0){const Te=Fe.slice(0,-1);Te?(v({...S,price:Ne(Te)}),xe(Te)):(v({...S,price:""}),xe(""));return}xe(Fe),v({...S,price:Ne(Fe)})},He=async(G,Le=2)=>{const Fe=Le*1024*1024;if(G.size<=Fe)return G;try{const Te=await createImageBitmap(G),Me=document.createElement("canvas");let Ie=Te.width,De=Te.height;const Re=1200;return(Ie>Re||De>Re)&&(Ie>De?(De=Math.round(De/Ie*Re),Ie=Re):(Ie=Math.round(Ie/De*Re),De=Re)),Me.width=Ie,Me.height=De,Me.getContext("2d").drawImage(Te,0,0,Ie,De),Te.close(),new Promise((Je,Xe)=>{Me.toBlob(Ke=>{Ke?Je(new File([Ke],G.name.replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg"})):Xe(new Error("Kh\xF4ng n\xE9n \u0111\u01B0\u1EE3c \u1EA3nh"))},"image/jpeg",.8)})}catch(Te){throw console.error("Compress error:",Te),new Error("Kh\xF4ng th\u1EC3 x\u1EED l\xFD \u1EA3nh. Th\u1EED ch\u1ECDn \u1EA3nh kh\xE1c.")}},qe=async G=>{var Te;const Le=G.target.files[0];if(!Le)return;if(!(Le.type.startsWith("image/")||/\.(jpg|jpeg|png|gif|webp)$/i.test(Le.name))){alert("Vui l\xF2ng ch\u1ECDn file \u1EA3nh!");return}ie(!0);try{const Me=await He(Le),Ie=new FormData;Ie.append("file",Me),Ie.append("upload_preset",CLOUDINARY_UPLOAD_PRESET),Ie.append("folder","ktm-products");const De=await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`,{method:"POST",body:Ie}),Re=await De.json();if(!De.ok)throw console.error("Cloudinary error:",Re),new Error(((Te=Re.error)==null?void 0:Te.message)||"Upload failed");v(Be=>({...Be,image:Re.secure_url}))}catch(Me){console.error("Upload error:",Me),alert("L\u1ED7i upload \u1EA3nh: "+Me.message)}ie(!1),G.target.value=""},Qe=async G=>{G.preventDefault(),K(!0),await w(S),K(!1)};return e?React.createElement("div",{className:"modal show d-block",style:{background:"rgba(0,0,0,0.6)"}},React.createElement("div",{className:"modal-dialog modal-dialog-centered modal-lg"},React.createElement("div",{className:"modal-content",style:{borderRadius:16,border:"none",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"}},React.createElement("div",{className:"modal-header",style:{background:"linear-gradient(135deg, #ffc107, #ff9800)",border:"none",borderRadius:"16px 16px 0 0"}},React.createElement("h5",{className:"modal-title fw-bold text-dark"},React.createElement("i",{className:"fas fa-box me-2"}),r?"S\u1EEDa s\u1EA3n ph\u1EA9m":"Th\xEAm s\u1EA3n ph\u1EA9m m\u1EDBi"),React.createElement("button",{type:"button",className:"btn-close",onClick:g})),React.createElement("form",{onSubmit:Qe},React.createElement("div",{className:"modal-body",style:{maxHeight:"70vh",overflowY:"auto"}},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-8"},React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},React.createElement("i",{className:"fas fa-tag me-1"}),"T\xEAn s\u1EA3n ph\u1EA9m *"),React.createElement("input",{type:"text",className:"form-control",value:S.name,onChange:G=>v({...S,name:G.target.value}),placeholder:"V\xED d\u1EE5: Xy lanh nghi\xEAng KTM",required:!0,style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}})),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-6"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},React.createElement("i",{className:"fas fa-hashtag me-1"}),"M\xE3 s\u1EA3n ph\u1EA9m"),React.createElement("input",{type:"text",className:"form-control",value:S.code,onChange:G=>v({...S,code:G.target.value}),placeholder:"KTM-01",style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}})),React.createElement("div",{className:"col-6"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},React.createElement("i",{className:"fas fa-dollar-sign me-1"}),"Gi\xE1 b\xE1n"),React.createElement("input",{type:"text",className:"form-control",value:S.price,onChange:Ue,placeholder:"1.950.000\u0111",style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}}))),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},React.createElement("i",{className:"fas fa-list me-1"}),"Danh m\u1EE5c"),React.createElement("select",{className:"form-select",value:S.category,onChange:G=>v({...S,category:G.target.value}),style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}},React.createElement("option",{value:""},"Ch\u1ECDn danh m\u1EE5c"),c.map(G=>React.createElement("option",{key:G,value:G},G)))),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},React.createElement("i",{className:"fas fa-sticky-note me-1"}),"Ghi ch\xFA"),React.createElement("textarea",{className:"form-control",rows:"2",value:S.note,onChange:G=>v({...S,note:G.target.value}),placeholder:"V\xED d\u1EE5: Th\xEAm d\xE2y l\xE0 2.150.000\u0111",style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}}))),React.createElement("div",{className:"col-md-4"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},React.createElement("i",{className:"fas fa-image me-1"}),"\u1EA2nh s\u1EA3n ph\u1EA9m"),React.createElement("div",{className:"mb-2"},S.image?React.createElement(React.Fragment,null,React.createElement("img",{src:S.image,alt:"Product",style:{width:"100%",height:150,objectFit:"cover",borderRadius:"12px",border:"2px solid #e9ecef"}}),React.createElement("button",{type:"button",className:"btn btn-sm btn-danger mt-2",onClick:()=>v({...S,image:""}),style:{borderRadius:"20px",fontSize:"0.75rem"}},React.createElement("i",{className:"fas fa-times me-1"}),"X\xF3a \u1EA3nh")):React.createElement("div",{className:"d-flex align-items-center justify-content-center",style:{width:"100%",height:150,borderRadius:"12px",background:"linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%)",border:"2px dashed #adb5bd",cursor:"pointer"},onClick:()=>{var G;return(G=Q.current)==null?void 0:G.click()}},React.createElement("div",{className:"text-center"},React.createElement("i",{className:"fas fa-cloud-upload-alt fa-2x text-muted mb-2"}),React.createElement("div",{className:"small text-muted"},"Click \u0111\u1EC3 upload")))),React.createElement("input",{ref:Q,type:"file",accept:"image/*",className:"d-none",onChange:qe}),React.createElement("button",{type:"button",className:"btn btn-outline-secondary w-100",onClick:()=>{var G;return(G=Q.current)==null?void 0:G.click()},disabled:ne,style:{borderRadius:"10px"}},ne?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang upload..."):React.createElement(React.Fragment,null,React.createElement("i",{className:"fas fa-upload me-2"}),"Upload \u1EA3nh")),React.createElement("div",{className:"mt-2"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},React.createElement("i",{className:"fas fa-link me-1"}),"Ho\u1EB7c URL \u1EA3nh"),React.createElement("input",{type:"url",className:"form-control",value:S.image,onChange:G=>v({...S,image:G.target.value}),placeholder:"https://...",style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"8px",fontSize:"0.875rem"}}))))),React.createElement("div",{className:"modal-footer",style:{border:"none",padding:"20px"}},React.createElement("button",{type:"button",className:"btn btn-light px-4",onClick:g,style:{borderRadius:"10px"}},"H\u1EE7y"),React.createElement("button",{type:"submit",className:"btn btn-warning px-4 fw-semibold",disabled:k,style:{borderRadius:"10px",boxShadow:"0 4px 12px rgba(255,193,7,0.3)"}},k?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang l\u01B0u..."):React.createElement(React.Fragment,null,React.createElement("i",{className:"fas fa-check me-2"}),"L\u01B0u s\u1EA3n ph\u1EA9m"))))))):null}const i=(e,r)=>{const c=e._type==="product",g=e._type==="album",w=e._type==="video",S=e.note&&(e.note.toLowerCase().includes("free")||e.note.toLowerCase().includes("gi\u1EA3m")||e.note.toLowerCase().includes("sale"));return H==="grid"?React.createElement("div",{key:e.id||r,className:"grid-card"},React.createElement("div",{className:"thumb-wrap",onClick:()=>ve({url:e.image,name:e.name,price:e.price,note:e.note,item:e})},e.image?React.createElement("img",{src:e.image,alt:e.name,className:"thumb",loading:"lazy"}):React.createElement("div",{className:"thumb d-flex align-items-center justify-content-center bg-light"},React.createElement("i",{className:`fas ${w?"fa-video":"fa-image"} fa-2x text-muted`})),e.price&&React.createElement("div",{className:"price-overlay"},e.price.replace(/[đ\s]/g,""),"\u0111"),React.createElement("span",{className:`type-badge ${c?"product":g?"album":"video"}`},c?"SP":g?"\u1EA2nh":"Video"),S&&React.createElement("span",{className:"promo-badge"},"\u{1F525} \u01AFU \u0110\xC3I")),React.createElement("div",{className:"card-body"},React.createElement("div",{className:"name"},e.name),e.note&&React.createElement("div",{className:"meta text-info",style:{fontSize:10}},e.note),React.createElement("div",{className:"quick-copy"},React.createElement("button",{className:I===e.id+"-img"?"copied":"",onClick:()=>z(e.image,e.id)},React.createElement("i",{className:"fas fa-image"})),e.price&&React.createElement("button",{className:I===e.id+"-price"?"copied":"",onClick:()=>x(e.price.replace(/[đ\s]/g,""),e.id+"-price")},React.createElement("i",{className:"fas fa-tag"}))))):React.createElement("div",{key:e.id||r,className:"product-card-mobile"},React.createElement("span",{className:`type-badge ${c?"product":g?"album":"video"}`},c?"S\u1EA3n ph\u1EA9m":g?"\u1EA2nh":"Video"),React.createElement("div",{className:"card-inner"},e.image?React.createElement("img",{src:e.image,alt:e.name,className:"thumb",loading:"lazy",onClick:()=>ve({url:e.image,name:e.name,price:e.price,note:e.note,item:e})}):React.createElement("div",{className:"thumb d-flex align-items-center justify-content-center bg-light"},React.createElement("i",{className:`fas ${w?"fa-video":"fa-image"} fa-2x text-muted`})),React.createElement("div",{className:"info"},React.createElement("div",null,React.createElement("div",{className:"name"},e.name),React.createElement("div",{className:"price-row"},e.price&&React.createElement("span",{className:"price"},e.price.replace(/[đ\s]/g,""),"\u0111"),S&&React.createElement("span",{className:"badge-promo"},"\u{1F525} \u01AFU \u0110\xC3I"))),React.createElement("div",{className:"meta"},e.code&&React.createElement("span",{className:"meta-tag"},"#",e.code),e.category&&React.createElement("span",{className:"meta-tag"},e.category),e.note&&React.createElement("span",{className:"meta-tag highlight"},e.note),e.folder&&React.createElement("span",{className:"meta-tag"},e.folder),w&&React.createElement("span",{className:"meta-tag"},React.createElement("i",{className:"fab fa-youtube text-danger"})," Video")))),React.createElement("div",{className:"quick-actions"},c&&React.createElement("button",{onClick:()=>m&&m("orders","create",{productId:e.id})},React.createElement("i",{className:"fas fa-receipt"})," T\u1EA1o \u0111\u01A1n"),React.createElement("button",{className:I===e.id+"-img"?"copied":"",onClick:()=>z(e.image,e.id)},React.createElement("i",{className:"fas fa-image"})," \u1EA2nh"),e.price&&React.createElement("button",{className:I===e.id+"-price"?"copied":"",onClick:()=>x(e.price.replace(/[đ\s]/g,""),e.id+"-price")},React.createElement("i",{className:"fas fa-tag"})," Gi\xE1"),React.createElement("button",{className:I===e.id+"-name"?"copied":"",onClick:()=>x(e.name,e.id+"-name")},React.createElement("i",{className:"fas fa-font"})," T\xEAn"),w&&e.youtubeId&&React.createElement("button",{className:I===e.id+"-yt"?"copied":"",onClick:()=>x(`https://www.youtube.com/watch?v=${e.youtubeId}`,e.id+"-yt")},React.createElement("i",{className:"fab fa-youtube"})),c&&React.createElement("button",{className:"action-edit",onClick:()=>se(e)},React.createElement("i",{className:"fas fa-pen"})),React.createElement("button",{className:"action-delete",onClick:()=>le(e)},React.createElement("i",{className:"fas fa-trash"}))))},[s,u]=useState(!1);return React.createElement(React.Fragment,null,React.createElement("div",{className:"result-header"},React.createElement("span",null,React.createElement("strong",null,T.length)," k\u1EBFt qu\u1EA3",X&&D.length>=3&&React.createElement("span",{className:"ai-badge ms-2"},React.createElement("i",{className:"fas fa-robot"})," AI"),V!=="all"&&React.createElement("span",{className:"ms-2 badge bg-warning text-dark"},V==="product"?"S\u1EA3n ph\u1EA9m":V==="album"?"\u1EA2nh":"Video")),React.createElement("div",{className:"d-flex gap-1 align-items-center"},React.createElement("button",{className:`btn btn-sm ${H==="list"?"btn-dark":"btn-outline-secondary"}`,onClick:()=>F("list"),style:{padding:"4px 8px"}},React.createElement("i",{className:"fas fa-list"})),React.createElement("button",{className:`btn btn-sm ${H==="grid"?"btn-dark":"btn-outline-secondary"}`,onClick:()=>F("grid"),style:{padding:"4px 8px"}},React.createElement("i",{className:"fas fa-th"})))),React.createElement("div",{className:"search-results-area"},A?React.createElement("div",null,[...Array(8)].map((e,r)=>React.createElement("div",{key:r,className:"product-card-mobile mb-2",style:{opacity:.7}},React.createElement("div",{className:"card-inner"},React.createElement("div",{className:"thumb bg-light",style:{width:80,height:80,borderRadius:8}}),React.createElement("div",{className:"info",style:{flex:1,minWidth:0}},React.createElement("div",{className:"skeleton-box mb-2",style:{height:16,width:"60%",background:"#eee",borderRadius:4}}),React.createElement("div",{className:"skeleton-box mb-1",style:{height:12,width:"40%",background:"#f3f3f3",borderRadius:4}}),React.createElement("div",{className:"skeleton-box",style:{height:10,width:"30%",background:"#f3f3f3",borderRadius:4}})))))):T.length===0?React.createElement("div",{className:"empty-state"},React.createElement("i",{className:"fas fa-search"}),React.createElement("p",null,'Kh\xF4ng t\xECm th\u1EA5y "',D,'"'),React.createElement("button",{className:"btn btn-warning",onClick:()=>{j(""),Ae("")}},"Xem t\u1EA5t c\u1EA3")):H==="grid"?React.createElement("div",{className:"product-grid-mobile"},T.map((e,r)=>i(e,r))):React.createElement("div",null,T.map((e,r)=>i(e,r)))),s&&React.createElement("div",{className:"filter-dropdown"},React.createElement("div",{className:"filter-header"},React.createElement("strong",null,"L\u1ECDc theo lo\u1EA1i"),React.createElement("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>u(!1)},React.createElement("i",{className:"fas fa-times"}))),React.createElement("div",{className:"filter-chips"},React.createElement("span",{className:`filter-chip ${V==="all"?"active":""}`,onClick:()=>{o("all"),u(!1)}},"T\u1EA5t c\u1EA3"),React.createElement("span",{className:`filter-chip ${V==="product"?"active":""}`,onClick:()=>{o("product"),u(!1)}},React.createElement("i",{className:"fas fa-box me-1"}),"S\u1EA3n ph\u1EA9m"),React.createElement("span",{className:`filter-chip ${V==="album"?"active":""}`,onClick:()=>{o("album"),u(!1)}},React.createElement("i",{className:"fas fa-images me-1"}),"\u1EA2nh"),React.createElement("span",{className:`filter-chip ${V==="video"?"active":""}`,onClick:()=>{o("video"),u(!1)}},React.createElement("i",{className:"fas fa-video me-1"}),"Video")),React.createElement("div",{className:"mt-3 pt-3 border-top d-flex align-items-center justify-content-between"},React.createElement("span",null,"AI Search th\xF4ng minh"),React.createElement("div",{className:"form-check form-switch m-0"},React.createElement("input",{type:"checkbox",className:"form-check-input",checked:X,onChange:e=>N(e.target.checked),style:{width:40,height:20}})))),React.createElement("div",{className:"search-bar-bottom"},React.createElement("div",{className:"search-input-wrap"},React.createElement("input",{ref:O,type:"text",className:"search-input",placeholder:"\u{1F50D} T\xECm: van 3 tay, xylanh...",value:D,onChange:e=>Ae(e.target.value)}),React.createElement("button",{className:`filter-btn ${s||V!=="all"?"active":""}`,onClick:()=>u(!s)},React.createElement("i",{className:"fas fa-filter"})))),React.createElement("button",{className:"btn btn-lg rounded-circle position-fixed shadow-lg",style:{bottom:B?320:130,right:16,width:56,height:56,zIndex:1050,transition:"bottom 0.2s ease",background:"linear-gradient(135deg, #667eea, #764ba2)",color:"#fff",border:"none",WebkitTapHighlightColor:"transparent",touchAction:"manipulation",cursor:"pointer",outline:"none"},onClick:()=>ee(!0),onTouchStart:()=>ee(!0)},React.createElement("i",{className:"fas fa-robot fa-lg"})),ye&&React.createElement("div",{className:"ai-chat-mobile"},React.createElement("div",{className:"chat-header"},React.createElement("button",{className:"back-btn",onClick:()=>ee(!1)},React.createElement("i",{className:"fas fa-arrow-left"})),React.createElement("div",null,React.createElement("strong",null,"KTM AI Assistant"),React.createElement("div",{style:{fontSize:11,opacity:.8}},"H\u1ECFi v\u1EC1 s\u1EA3n ph\u1EA9m, gi\xE1 c\u1EA3..."))),React.createElement("div",{className:"chat-messages"},ae.map((e,r)=>React.createElement("div",{key:r,className:`mb-3 ${e.role==="user"?"d-flex justify-content-end":""}`},React.createElement("div",{className:`p-3 rounded-3 position-relative ${e.role==="user"?"text-white":"bg-white border"}`,style:{maxWidth:"85%",whiteSpace:"pre-wrap",background:e.role==="user"?"linear-gradient(135deg, #667eea, #764ba2)":void 0}},e.content,e.role==="assistant"&&React.createElement("button",{className:"btn btn-sm position-absolute",style:{top:4,right:4,padding:"2px 6px",fontSize:11,background:I===`chat-${r}`?"#28a745":"rgba(0,0,0,0.1)",border:"none",borderRadius:4,color:I===`chat-${r}`?"#fff":"#666"},onClick:()=>{navigator.clipboard.writeText(e.content),L(`chat-${r}`),setTimeout(()=>L(null),1500)}},React.createElement("i",{className:`fas ${I===`chat-${r}`?"fa-check":"fa-copy"}`})),e.attachments&&e.attachments.length>0&&React.createElement("div",{className:"mt-2 d-flex flex-wrap gap-2"},e.attachments.map((c,g)=>React.createElement("div",{key:g,style:{width:70},className:"text-center"},c.image&&React.createElement("img",{src:c.image,className:"rounded",style:{width:70,height:50,objectFit:"cover",cursor:"pointer"},onClick:()=>ve({url:c.image,name:c.name,price:c.price})}),React.createElement("div",{style:{fontSize:9},className:"text-truncate"},c.name),c.price&&React.createElement("div",{style:{fontSize:10,color:"#dc3545",fontWeight:600}},c.price.replace(/[đ\s]/g,""),"\u0111"))))))),ue&&React.createElement("div",{className:"mb-3"},React.createElement("div",{className:"bg-white border p-3 rounded-3 d-inline-block"},React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang suy ngh\u0129...")),React.createElement("div",{ref:ge})),React.createElement("div",{className:"px-3 py-2 border-top d-flex gap-2 overflow-auto"},["Gi\xE1 van 2 tay?","Combo r\u1EBB nh\u1EA5t?","Freeship?","Van 3 tay?"].map(e=>React.createElement("button",{key:e,className:"btn btn-sm btn-outline-secondary flex-shrink-0",onClick:()=>a(e),disabled:ue,style:{whiteSpace:"nowrap"}},e))),React.createElement("div",{className:"chat-input-area"},React.createElement("form",{onSubmit:e=>{e.preventDefault(),a(W)},className:"chat-input-wrap"},React.createElement("input",{ref:_e,type:"text",className:"chat-input",placeholder:"Nh\u1EADp c\xE2u h\u1ECFi...",value:W,onChange:e=>he(e.target.value),disabled:ue}),React.createElement("button",{type:"submit",className:"send-btn",disabled:ue||!W.trim()},React.createElement("i",{className:"fas fa-paper-plane"}))))),oe&&React.createElement("div",{className:"preview-modal",onClick:()=>ve(null)},React.createElement("div",{className:"preview-header"},React.createElement("div",null),React.createElement("button",{className:"close-btn",onClick:()=>ve(null)},React.createElement("i",{className:"fas fa-times"}))),React.createElement("div",{className:"preview-body",onClick:e=>e.stopPropagation()},React.createElement("img",{src:oe.url,alt:oe.name})),React.createElement("div",{className:"preview-footer",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"name"},oe.name),oe.price&&React.createElement("div",{className:"price"},oe.price.replace(/[đ\s]/g,""),"\u0111"),oe.note&&React.createElement("div",{className:"mb-2",style:{fontSize:14,color:"#17a2b8"}},oe.note),React.createElement("div",{className:"action-btns"},React.createElement("button",{className:I==="preview-img"?"btn-success text-white":"btn-outline-light text-white",style:{background:I==="preview-img"?"#28a745":"rgba(255,255,255,0.2)"},onClick:()=>z(oe.url,"preview")},React.createElement("i",{className:`fas ${I==="preview-img"?"fa-check":"fa-copy"}`}),"Copy \u1EA3nh"),oe.price&&React.createElement("button",{className:I==="preview-price"?"btn-success text-white":"btn-warning",onClick:()=>x(oe.price.replace(/[đ\s]/g,""),"preview-price")},React.createElement("i",{className:`fas ${I==="preview-price"?"fa-check":"fa-tag"}`}),"Copy gi\xE1")))),React.createElement(l,{show:$e,product:Ce,categories:E,onClose:()=>{we(!1),Ee(null)},onSave:pe}),React.createElement("div",{className:`fab-container mobile-only ${B?"open":""}`},React.createElement("div",{className:"fab-actions"},React.createElement("button",{className:"fab-action product",onClick:()=>{ce(!1),we(!0),Ee(null)}},React.createElement("i",{className:"fas fa-box"}),React.createElement("span",{className:"tooltip"},"Th\xEAm s\u1EA3n ph\u1EA9m")),React.createElement("button",{className:"fab-action product",onClick:()=>{ce(!1),m&&m("orders","create")}},React.createElement("i",{className:"fas fa-receipt"}),React.createElement("span",{className:"tooltip"},"T\u1EA1o order nhanh"))),React.createElement("button",{className:`fab-main ${B?"open":""}`,onClick:()=>ce(!B)},React.createElement("i",{className:"fas fa-plus"}))),je&&n&&React.createElement("div",{className:"modal show d-block",style:{background:"rgba(0,0,0,0.6)"}},React.createElement("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},React.createElement("div",{className:"modal-content",style:{borderRadius:16,maxHeight:"90vh"}},React.createElement("div",{className:"modal-header",style:{background:"linear-gradient(135deg, #ffc107, #ff9800)",border:"none"}},React.createElement("h6",{className:"modal-title fw-bold"},React.createElement("i",{className:"fas fa-pen me-2"}),"S\u1EEDa nhanh"),React.createElement("button",{type:"button",className:"btn-close",onClick:()=>t(!1)})),React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label small fw-semibold"},"T\xEAn s\u1EA3n ph\u1EA9m"),React.createElement("input",{type:"text",className:"form-control",value:M.name,onChange:e=>de({...M,name:e.target.value})})),React.createElement("div",{className:"row g-2 mb-3"},React.createElement("div",{className:"col-6"},React.createElement("label",{className:"form-label small fw-semibold"},"M\xE3 SP"),React.createElement("input",{type:"text",className:"form-control",value:M.code,onChange:e=>de({...M,code:e.target.value})})),React.createElement("div",{className:"col-6"},React.createElement("label",{className:"form-label small fw-semibold"},"Gi\xE1"),React.createElement("input",{type:"text",className:"form-control",value:M.price,onChange:e=>de({...M,price:e.target.value})}))),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label small fw-semibold"},"Danh m\u1EE5c"),React.createElement("select",{className:"form-select",value:M.category,onChange:e=>de({...M,category:e.target.value})},React.createElement("option",{value:""},"-- Ch\u1ECDn danh m\u1EE5c --"),Oe.map(e=>React.createElement("option",{key:e,value:e},e)))),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label small fw-semibold"},"Ghi ch\xFA (\u01B0u \u0111\xE3i)"),React.createElement("input",{type:"text",className:"form-control",value:M.note,placeholder:"VD: Free ship, Gi\u1EA3m 10%...",onChange:e=>de({...M,note:e.target.value})}))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>t(!1)},"H\u1EE7y"),React.createElement("button",{type:"button",className:"btn btn-warning",onClick:h},React.createElement("i",{className:"fas fa-save me-1"}),"L\u01B0u"))))))}function VideoList({onRefresh:y,showToast:m}){const[D,j]=useState([]),[T,d]=useState([]),[b,C]=useState(!0),[E,p]=useState(null),[V,q]=useState(!1),[I,L]=useState(null),[H,F]=useState(!1),[A,$]=useState(null),[R,Z]=useState(null),[J,f]=useState([]);useEffect(()=>{O()},[]);const O=async(t=null)=>{C(!0);try{const n=t?`${API_BASE}/api/video-folders?withVideos=true&parent_id=${t}`:`${API_BASE}/api/video-folders?withVideos=true&parent_id=root`,B=await(await fetch(n)).json();j(Array.isArray(B)?B:[])}catch(n){console.error(n),m("L\u1ED7i t\u1EA3i danh s\xE1ch folder","danger")}C(!1)},X=async t=>{try{const _=await(await fetch(`${API_BASE}/api/videos?folderId=${t}`)).json();d(Array.isArray(_)?_:[])}catch(n){console.error(n)}},N=async t=>{if(t===0)return;const n=[...D];[n[t-1],n[t]]=[n[t],n[t-1]],j(n),await P(n)},te=async t=>{if(t===D.length-1)return;const n=[...D];[n[t],n[t+1]]=[n[t+1],n[t]],j(n),await P(n)},P=async t=>{try{await Promise.all(t.map((n,_)=>fetch(`${API_BASE}/api/video-folders/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({sortOrder:_})}))),m("\u0110\xE3 c\u1EADp nh\u1EADt th\u1EE9 t\u1EF1!","success")}catch(n){m("L\u1ED7i c\u1EADp nh\u1EADt th\u1EE9 t\u1EF1","danger"),O(R==null?void 0:R.id)}},Y=async t=>{if(t===0)return;const n=[...T];[n[t-1],n[t]]=[n[t],n[t-1]],d(n),await ee(n)},ye=async t=>{if(t===T.length-1)return;const n=[...T];[n[t],n[t+1]]=[n[t+1],n[t]],d(n),await ee(n)},ee=async t=>{try{await Promise.all(t.map((n,_)=>fetch(`${API_BASE}/api/videos/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({sort_order:_})}))),m("\u0110\xE3 c\u1EADp nh\u1EADt th\u1EE9 t\u1EF1!","success")}catch(n){m("L\u1ED7i c\u1EADp nh\u1EADt th\u1EE9 t\u1EF1","danger"),X(E.id)}},ae=()=>{L(null),q(!0)},re=t=>{L(t),q(!0)},W=async t=>{try{!I&&R&&(t.parent_id=R.id);const n=I?`${API_BASE}/api/video-folders/${I.id}`:`${API_BASE}/api/video-folders`;if(!(await fetch(n,{method:I?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("L\u1ED7i l\u01B0u folder");m(I?"\u0110\xE3 c\u1EADp nh\u1EADt folder!":"\u0110\xE3 t\u1EA1o folder m\u1EDBi!","success"),q(!1),O(R==null?void 0:R.id)}catch(n){m(n.message,"danger")}},he=async t=>{const n=t.subfolderCount>0?`X\xF3a folder "${t.name}"? T\u1EA5t c\u1EA3 subfolder v\xE0 videos b\xEAn trong s\u1EBD b\u1ECB x\xF3a!`:`X\xF3a folder "${t.name}"? Videos trong folder s\u1EBD kh\xF4ng b\u1ECB x\xF3a.`;if(confirm(n))try{await fetch(`${API_BASE}/api/video-folders/${t.id}`,{method:"DELETE"}),m("\u0110\xE3 x\xF3a folder","success"),p(null),O(R==null?void 0:R.id)}catch(_){m("L\u1ED7i x\xF3a folder","danger")}},ue=t=>{t.subfolderCount>0?(f(n=>[...n,t]),Z(t),O(t.id)):(p(t),d(t.videos||[]))},U=t=>{if(t==="root")f([]),Z(null),O(null);else if(t){const n=J.findIndex(_=>_.id===t.id);n>=0&&(f(J.slice(0,n+1)),Z(t),O(t.id))}else{const n=[...J];n.pop();const _=n[n.length-1]||null;f(n),Z(_),O(_==null?void 0:_.id)}},ge=()=>{$(null),F(!0)},_e=t=>{$(t),F(!0)},oe=async t=>{try{t.folder_id=E==null?void 0:E.id;const n=A?`${API_BASE}/api/videos/${A.id}`:`${API_BASE}/api/videos`,_=await fetch(n,{method:A?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!_.ok){const B=await _.json();throw new Error(B.error||"L\u1ED7i l\u01B0u video")}m(A?"C\u1EADp nh\u1EADt th\xE0nh c\xF4ng!":"Th\xEAm video th\xE0nh c\xF4ng!","success"),F(!1),O(),E&&X(E.id)}catch(n){m(n.message,"danger")}},ve=async t=>{if(confirm(`X\xF3a video "${t.title}"?`))try{await fetch(`${API_BASE}/api/videos/${t.id}`,{method:"DELETE"}),m("\u0110\xE3 x\xF3a video","success"),O(),E&&X(E.id)}catch(n){m("L\u1ED7i x\xF3a video","danger")}},je=t=>{const n=`https://www.youtube.com/watch?v=${t.youtubeId}`;navigator.clipboard.writeText(n).then(()=>{m("\u0110\xE3 copy link!","success")}).catch(()=>{m("Kh\xF4ng th\u1EC3 copy link","danger")})};return E?React.createElement("div",null,React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},React.createElement("div",{className:"d-flex align-items-center"},React.createElement("button",{className:"btn btn-outline-secondary me-3",onClick:()=>p(null)},React.createElement("i",{className:"fas fa-arrow-left"})),React.createElement("h4",{className:"m-0"},React.createElement("i",{className:`fas fa-folder-open me-2 ${E.slug==="shorts"?"text-danger":"text-warning"}`}),E.name)),React.createElement("button",{className:"btn btn-warning",onClick:ge},React.createElement("i",{className:"fas fa-plus me-2"}),"Th\xEAm Video")),React.createElement("p",{className:"text-muted small mb-3"},React.createElement("i",{className:"fas fa-info-circle me-1"}),"D\xF9ng n\xFAt \u2191\u2193 \u0111\u1EC3 s\u1EAFp x\u1EBFp th\u1EE9 t\u1EF1 videos"),T.length===0?React.createElement("div",{className:"text-center py-5"},React.createElement("i",{className:"fas fa-video fa-3x text-muted mb-3"}),React.createElement("p",{className:"text-muted"},"Ch\u01B0a c\xF3 video trong folder n\xE0y")):React.createElement("div",{className:"row g-4"},T.map((t,n)=>React.createElement("div",{key:t.id,className:"col-6 col-md-4 col-lg-3"},React.createElement("div",{className:"card h-100"},React.createElement("div",{className:"card-header bg-transparent py-1 d-flex justify-content-center gap-1"},React.createElement("button",{className:"btn btn-sm btn-outline-secondary px-2 py-0",onClick:()=>Y(n),disabled:n===0,title:"Di chuy\u1EC3n l\xEAn"},React.createElement("i",{className:"fas fa-chevron-up"})),React.createElement("span",{className:"text-muted small px-1"},n+1),React.createElement("button",{className:"btn btn-sm btn-outline-secondary px-2 py-0",onClick:()=>ye(n),disabled:n===T.length-1,title:"Di chuy\u1EC3n xu\u1ED1ng"},React.createElement("i",{className:"fas fa-chevron-down"}))),React.createElement("div",{className:"position-relative"},React.createElement("img",{src:t.thumb,className:"card-img-top",alt:t.title,style:{height:"120px",objectFit:"cover"}}),React.createElement("a",{href:`https://www.youtube.com/watch?v=${t.youtubeId}`,target:"_blank",className:"position-absolute top-50 start-50 translate-middle"},React.createElement("i",{className:"fas fa-play-circle fa-3x text-white",style:{textShadow:"0 2px 10px rgba(0,0,0,0.5)"}}))),React.createElement("div",{className:"card-body py-2"},React.createElement("h6",{className:"card-title small mb-1 text-truncate",title:t.title},t.title),React.createElement("small",{className:"text-muted"},t.youtubeId)),React.createElement("div",{className:"card-footer bg-transparent border-0 pt-0"},React.createElement("div",{className:"btn-group btn-group-sm w-100"},React.createElement("button",{className:"btn btn-outline-primary",onClick:()=>je(t),title:"Copy link"},React.createElement("i",{className:"fas fa-link"})),React.createElement("button",{className:"btn btn-outline-secondary",onClick:()=>_e(t),title:"S\u1EEDa"},React.createElement("i",{className:"fas fa-edit"})),React.createElement("button",{className:"btn btn-outline-danger",onClick:()=>ve(t),title:"X\xF3a"},React.createElement("i",{className:"fas fa-trash"})))))))),React.createElement(VideoModal,{show:H,video:A,onClose:()=>F(!1),onSave:oe})):React.createElement("div",null,React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3"},React.createElement("div",{className:"d-flex align-items-center"},R&&React.createElement("button",{className:"btn btn-outline-secondary me-3",onClick:()=>U()},React.createElement("i",{className:"fas fa-arrow-left"})),React.createElement("h4",{className:"m-0"},React.createElement("i",{className:"fas fa-video me-2 text-warning"}),R?R.name:"Qu\u1EA3n l\xFD Video")),React.createElement("button",{className:"btn btn-warning",onClick:ae},React.createElement("i",{className:"fas fa-folder-plus me-2"}),"T\u1EA1o Folder")),J.length>0&&React.createElement("nav",{"aria-label":"breadcrumb",className:"mb-3"},React.createElement("ol",{className:"breadcrumb mb-0"},React.createElement("li",{className:"breadcrumb-item"},React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),U("root")},className:"text-warning"},React.createElement("i",{className:"fas fa-home"}))),J.map((t,n)=>React.createElement("li",{key:t.id,className:`breadcrumb-item ${n===J.length-1?"active":""}`},n===J.length-1?t.name:React.createElement("a",{href:"#",onClick:_=>{_.preventDefault(),U(t)},className:"text-warning"},t.name))))),React.createElement("p",{className:"text-muted small mb-3"},React.createElement("i",{className:"fas fa-info-circle me-1"}),"D\xF9ng n\xFAt \u2191\u2193 \u0111\u1EC3 s\u1EAFp x\u1EBFp th\u1EE9 t\u1EF1. Click v\xE0o folder \u0111\u1EC3 v\xE0o b\xEAn trong."),b?React.createElement("div",{className:"text-center py-5"},React.createElement("div",{className:"spinner-border text-warning"})):D.length===0?React.createElement("div",{className:"text-center py-5"},React.createElement("i",{className:"fas fa-folder-open fa-3x text-muted mb-3"}),React.createElement("p",{className:"text-muted"},R?"Folder n\xE0y \u0111ang tr\u1ED1ng":"Ch\u01B0a c\xF3 folder video n\xE0o"),React.createElement("button",{className:"btn btn-warning",onClick:ae},React.createElement("i",{className:"fas fa-plus me-2"}),"T\u1EA1o folder",R?" con":" \u0111\u1EA7u ti\xEAn")):React.createElement("div",{className:"row g-3"},D.map((t,n)=>{var _,B,ce,$e;return React.createElement("div",{key:t.id,className:"col-6 col-md-4 col-lg-3"},React.createElement("div",{className:"card h-100 folder-card"},React.createElement("div",{className:"card-header bg-transparent py-1 d-flex justify-content-center gap-1"},React.createElement("button",{className:"btn btn-sm btn-outline-secondary px-2 py-0",onClick:we=>{we.stopPropagation(),N(n)},disabled:n===0,title:"Di chuy\u1EC3n l\xEAn"},React.createElement("i",{className:"fas fa-chevron-up"})),React.createElement("span",{className:"text-muted small px-1"},n+1),React.createElement("button",{className:"btn btn-sm btn-outline-secondary px-2 py-0",onClick:we=>{we.stopPropagation(),te(n)},disabled:n===D.length-1,title:"Di chuy\u1EC3n xu\u1ED1ng"},React.createElement("i",{className:"fas fa-chevron-down"}))),React.createElement("div",{className:"card-body text-center py-3",onClick:()=>ue(t),style:{cursor:"pointer"}},React.createElement("i",{className:`fas fa-folder fa-3x mb-3 ${t.slug==="shorts"?"text-danger":"text-warning"}`}),React.createElement("h5",{className:"card-title"},t.name),React.createElement("p",{className:"text-muted mb-0"},t.subfolderCount>0&&React.createElement("span",null,React.createElement("i",{className:"fas fa-folder me-1"}),t.subfolderCount," folder"),t.subfolderCount>0&&(t.videoCount>0||((_=t.videos)==null?void 0:_.length)>0)&&" \u2022 ",(t.videoCount>0||((B=t.videos)==null?void 0:B.length)>0)&&React.createElement("span",null,React.createElement("i",{className:"fas fa-video me-1"}),t.videoCount||((ce=t.videos)==null?void 0:ce.length)||0," videos"),t.subfolderCount===0&&!t.videoCount&&!(($e=t.videos)!=null&&$e.length)&&"Tr\u1ED1ng")),React.createElement("div",{className:"card-footer bg-transparent border-0"},React.createElement("div",{className:"btn-group btn-group-sm w-100"},React.createElement("button",{className:"btn btn-outline-secondary",onClick:we=>{we.stopPropagation(),re(t)}},React.createElement("i",{className:"fas fa-edit"})," S\u1EEDa"),React.createElement("button",{className:"btn btn-outline-danger",onClick:we=>{we.stopPropagation(),he(t)}},React.createElement("i",{className:"fas fa-trash"})," X\xF3a")))))})),React.createElement(VideoFolderModal,{show:V,folder:I,onClose:()=>q(!1),onSave:W}))}function VideoFolderModal({show:y,folder:m,onClose:D,onSave:j}){const[T,d]=useState({name:"",description:"",sortOrder:0,coverImage:""}),[b,C]=useState(!1),[E,p]=useState(!1);useEffect(()=>{d(m?{name:m.name||"",description:m.description||"",sortOrder:m.sortOrder||0,coverImage:m.coverImage||""}:{name:"",description:"",sortOrder:0,coverImage:""})},[m,y]);const V=async I=>{const L=I.target.files[0];if(!L)return;p(!0);const H=new FormData;H.append("file",L),H.append("upload_preset","ktm_unsigned");try{const A=await(await fetch("https://api.cloudinary.com/v1_1/diwxfpt92/image/upload",{method:"POST",body:H})).json();A.secure_url&&d($=>({...$,coverImage:A.secure_url})),localStorage.removeItem(CACHE_KEY),showToast("C\u1EADp nh\u1EADt th\xE0nh c\xF4ng!","success"),setShowQuickEdit(!1),setEditingItem(null),loadAllData()}catch(F){console.error("Cloudinary upload error:",F),alert("L\u1ED7i upload \u1EA3nh: "+(F.message||F))}finally{p(!1)}},q=async I=>{I.preventDefault(),C(!0),await j(T),C(!1)};return y?React.createElement("div",{className:"modal show d-block",style:{background:"rgba(0,0,0,0.5)"}},React.createElement("div",{className:"modal-dialog modal-dialog-centered"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("h5",{className:"modal-title"},m?"S\u1EEDa Folder":"T\u1EA1o Folder m\u1EDBi"),React.createElement("button",{type:"button",className:"btn-close",onClick:D})),React.createElement("form",{onSubmit:q},React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"T\xEAn folder *"),React.createElement("input",{type:"text",className:"form-control",value:T.name,onChange:I=>d({...T,name:I.target.value}),required:!0})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"M\xF4 t\u1EA3"),React.createElement("textarea",{className:"form-control",value:T.description,onChange:I=>d({...T,description:I.target.value}),rows:"2"})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"Th\u1EE9 t\u1EF1"),React.createElement("input",{type:"number",className:"form-control",value:T.sortOrder,onChange:I=>d({...T,sortOrder:parseInt(I.target.value)||0})})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"\u1EA2nh b\xECa"),React.createElement("div",{className:"d-flex align-items-start gap-3"},T.coverImage?React.createElement("div",{className:"position-relative"},React.createElement("img",{src:T.coverImage,alt:"Cover",className:"rounded",style:{width:120,height:80,objectFit:"cover"}}),React.createElement("button",{type:"button",className:"btn btn-sm btn-danger position-absolute top-0 end-0",onClick:()=>d({...T,coverImage:""}),style:{transform:"translate(30%, -30%)"}},React.createElement("i",{className:"fas fa-times"}))):React.createElement("div",{className:"bg-light rounded d-flex align-items-center justify-content-center text-muted",style:{width:120,height:80}},React.createElement("i",{className:"fas fa-image fa-2x"})),React.createElement("div",{className:"flex-grow-1"},React.createElement("input",{type:"file",className:"form-control form-control-sm",accept:"image/*,image/jpeg,image/png,image/gif,image/webp",onChange:V,disabled:E}),E&&React.createElement("div",{className:"mt-1 text-muted small"},React.createElement("span",{className:"spinner-border spinner-border-sm me-1"}),"\u0110ang upload..."),React.createElement("div",{className:"mt-1 text-muted small"},"Ho\u1EB7c d\xE1n URL:"),React.createElement("input",{type:"url",className:"form-control form-control-sm",placeholder:"https://...",value:T.coverImage,onChange:I=>d({...T,coverImage:I.target.value})}))))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"button",className:"btn btn-secondary",onClick:D},"H\u1EE7y"),React.createElement("button",{type:"submit",className:"btn btn-warning",disabled:b},b?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang l\u01B0u..."):"L\u01B0u")))))):null}function ProductManager({showToast:y}){const[m,D]=useState([]),[j,T]=useState(!0),[d,b]=useState(!1),[C,E]=useState(null),[p,V]=useState(""),[q,I]=useState(""),L=["Ty xy lanh","Combo Van 1 tay","Combo Van 2 tay","Combo Van 3 tay","Combo Van 4 tay","Combo Van 5 tay","Trang g\u1EA1t","Ph\u1EE5 ki\u1EC7n","Van \u0111i\u1EC1u khi\u1EC3n"];useEffect(()=>{H()},[]);const H=async()=>{T(!0);try{const O=await(await fetch(`${API_BASE}/api/products`)).json();D(Array.isArray(O)?O:[])}catch(f){console.error(f),y("L\u1ED7i t\u1EA3i s\u1EA3n ph\u1EA9m","danger")}T(!1)},F=()=>{E(null),b(!0)},A=f=>{E(f),b(!0)},$=async f=>{if(!(!f||!f.includes("cloudinary.com")))try{await fetch(`${API_BASE}/api/products?action=delete-image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:f})}),localStorage.removeItem(CACHE_KEY),y(`\u0110\xE3 x\xF3a ${typeName}`,"success"),loadAllData(),H()}catch(O){y("L\u1ED7i x\xF3a s\u1EA3n ph\u1EA9m","danger")}},R=async f=>{try{const O=C?`${API_BASE}/api/products?id=${C.id}`:`${API_BASE}/api/products`;if(!(await fetch(O,{method:C?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)})).ok)throw new Error("L\u1ED7i l\u01B0u s\u1EA3n ph\u1EA9m");y(C?"C\u1EADp nh\u1EADt th\xE0nh c\xF4ng!":"Th\xEAm s\u1EA3n ph\u1EA9m th\xE0nh c\xF4ng!","success"),b(!1),H()}catch(O){y(O.message,"danger")}},Z=async f=>{if(confirm(`B\u1EA1n c\xF3 ch\u1EAFc mu\u1ED1n x\xF3a s\u1EA3n ph\u1EA9m "${f.name}"?`))try{if(!(await fetch(`${API_BASE}/api/products?id=${f.id}`,{method:"DELETE"})).ok)throw new Error("L\u1ED7i x\xF3a s\u1EA3n ph\u1EA9m");y("X\xF3a s\u1EA3n ph\u1EA9m th\xE0nh c\xF4ng!","success"),H()}catch(O){y(O.message,"danger")}},J=m.filter(f=>{const O=!p||f.name.toLowerCase().includes(p.toLowerCase())||f.code&&f.code.toLowerCase().includes(p.toLowerCase()),X=!q||f.category===q;return O&&X});return React.createElement("div",{className:"product-manager pb-5 mb-4"},React.createElement("div",{className:"product-header"},React.createElement("h5",null,React.createElement("i",{className:"fas fa-box me-2"}),"S\u1EA3n ph\u1EA9m"),React.createElement("button",{className:"btn-add-product",onClick:F},React.createElement("i",{className:"fas fa-plus me-1"}),"Th\xEAm m\u1EDBi")),React.createElement("div",{className:"product-search"},React.createElement("div",{className:"d-flex gap-2 mb-2"},React.createElement("div",{className:"flex-grow-1 position-relative"},React.createElement("input",{type:"text",className:"form-control",placeholder:"\u{1F50D} T\xECm s\u1EA3n ph\u1EA9m...",value:p,onChange:f=>V(f.target.value)})),React.createElement("span",{className:"product-count"},J.length)),React.createElement("select",{className:"form-select",value:q,onChange:f=>I(f.target.value)},React.createElement("option",{value:""},"\u{1F4C1} T\u1EA5t c\u1EA3 danh m\u1EE5c"),L.map(f=>React.createElement("option",{key:f,value:f},f)))),j?React.createElement("div",{className:"text-center py-5"},React.createElement("div",{className:"spinner-border text-warning",style:{width:"2.5rem",height:"2.5rem"}}),React.createElement("p",{className:"text-muted mt-3 mb-0"},"\u0110ang t\u1EA3i...")):J.length===0?React.createElement("div",{className:"empty-state"},React.createElement("i",{className:"fas fa-box-open"}),React.createElement("p",null,"Ch\u01B0a c\xF3 s\u1EA3n ph\u1EA9m n\xE0o"),React.createElement("button",{className:"btn btn-warning",onClick:F},React.createElement("i",{className:"fas fa-plus me-2"}),"Th\xEAm s\u1EA3n ph\u1EA9m \u0111\u1EA7u ti\xEAn")):React.createElement("div",{className:"product-list"},J.map(f=>React.createElement("div",{key:f.id,className:"product-item d-flex align-items-center gap-3"},f.image?React.createElement("img",{src:f.image,alt:"",className:"product-img"}):React.createElement("div",{className:"product-img-placeholder"},React.createElement("i",{className:"fas fa-image text-muted"})),React.createElement("div",{className:"flex-grow-1 min-width-0"},React.createElement("div",{className:"product-name"},f.name),React.createElement("div",{className:"d-flex flex-wrap gap-1 mb-1"},f.category&&React.createElement("span",{className:"product-badge bg-info bg-opacity-75"},f.category),f.code&&React.createElement("span",{className:"product-badge bg-secondary"},f.code)),React.createElement("div",{className:"product-price"},f.price?f.price.replace(/[đ\s]/g,"")+"\u0111":"Li\xEAn h\u1EC7"),f.note&&React.createElement("div",{className:"text-muted small mt-1",style:{fontSize:"0.75rem"}},f.note)),React.createElement("div",{className:"product-actions"},React.createElement("button",{className:"btn btn-edit",onClick:()=>A(f),title:"S\u1EEDa"},React.createElement("i",{className:"fas fa-pen"})),React.createElement("button",{className:"btn btn-delete",onClick:()=>Z(f),title:"X\xF3a"},React.createElement("i",{className:"fas fa-trash"})))))),React.createElement(ProductModal,{show:d,product:C,categories:L,onClose:()=>b(!1),onSave:R}))}function ProductModal({show:y,product:m,categories:D,onClose:j,onSave:T}){const[d,b]=useState({name:"",code:"",price:"",image:"",category:"",note:"",sort_order:0}),[C,E]=useState(!1),[p,V]=useState(!1);useEffect(()=>{b(m?{name:m.name||"",code:m.code||"",price:m.price||"",image:m.image||"",category:m.category||"",note:m.note||"",sort_order:m.sort_order||0}:{name:"",code:"",price:"",image:"",category:"",note:"",sort_order:0})},[m,y]);const[q,I]=React.useState(""),L=N=>{const te=N.replace(/[^\d]/g,"");return te?te.replace(/\B(?=(\d{3})+(?!\d))/g,".")+"\u0111":""},[H,F]=React.useState(""),A=N=>{const P=N.target.value.replace(/[^\d]/g,"");if(!P){b({...d,price:""}),F("");return}if(P===H&&P.length>0){const Y=P.slice(0,-1);Y?(b({...d,price:L(Y)}),F(Y)):(b({...d,price:""}),F(""));return}F(P),b({...d,price:L(P)})},[$,R]=React.useState("");React.useEffect(()=>{m!=null&&m.image&&R(m.image)},[m]);const Z=async N=>{if(!(!N||!N.includes("cloudinary.com")))try{await fetch(`${API_BASE}/api/products?action=delete-image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:N})})}catch(te){console.error("Delete cloudinary image error:",te)}},J=async(N,te=2,P)=>{const Y=te*1024*1024,ye=N.type==="image/heic"||N.type==="image/heif"||/\.heic$/i.test(N.name);if(N.size<=Y&&!ye)return N;P==null||P("\u0110ang x\u1EED l\xFD \u1EA3nh...");try{const ee=await createImageBitmap(N);P==null||P("\u0110ang n\xE9n \u1EA3nh...");const ae=document.createElement("canvas");let re=ee.width,W=ee.height;const he=1200;return(re>he||W>he)&&(re>W?(W=Math.round(W/re*he),re=he):(re=Math.round(re/W*he),W=he)),ae.width=re,ae.height=W,ae.getContext("2d").drawImage(ee,0,0,re,W),ee.close(),new Promise((U,ge)=>{ae.toBlob(_e=>{_e?(P==null||P("Ho\xE0n t\u1EA5t!"),U(new File([_e],N.name.replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg"}))):ge(new Error("Kh\xF4ng n\xE9n \u0111\u01B0\u1EE3c \u1EA3nh"))},"image/jpeg",.7)})}catch(ee){throw console.error("createImageBitmap error:",ee),new Error("Kh\xF4ng th\u1EC3 x\u1EED l\xFD \u1EA3nh. Th\u1EED ch\u1ECDn \u1EA3nh kh\xE1c.")}},f=async N=>{var Y,ye;const te=(Y=N.target.files)==null?void 0:Y[0];if(!te)return;if(!(te.type.startsWith("image/")||/\.(jpg|jpeg|png|gif|webp|heic|heif)$/i.test(te.name))){alert("Vui l\xF2ng ch\u1ECDn file \u1EA3nh!");return}V(!0),I("\u0110ang chu\u1EA9n b\u1ECB...");try{const ee=(te.size/1024/1024).toFixed(1);I(`File ${ee}MB - \u0110ang n\xE9n...`);const ae=await J(te,2,U=>{I(U)}),re=(ae.size/1024/1024).toFixed(1);I(`\u0110\xE3 n\xE9n: ${re}MB - \u0110ang upload...`);const W=new FormData;W.append("file",ae),W.append("upload_preset","ktm_unsigned");const ue=await(await fetch("https://api.cloudinary.com/v1_1/diwxfpt92/image/upload",{method:"POST",body:W})).json();ue.secure_url?(d.image&&d.image!==$&&Z(d.image),b(U=>({...U,image:ue.secure_url})),I("")):(console.error("Cloudinary error:",ue),alert("Upload th\u1EA5t b\u1EA1i: "+(((ye=ue.error)==null?void 0:ye.message)||"L\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh")),I(""))}catch(ee){console.error("Upload error:",ee),alert("L\u1ED7i: "+ee.message),I("")}V(!1),N.target.value=""},O=()=>{d.image&&(d.image!==$&&Z(d.image),b(N=>({...N,image:""})))},X=async N=>{N.preventDefault(),E(!0),$&&d.image&&$!==d.image&&await Z($),$&&!d.image&&await Z($),await T(d),E(!1)};return y?React.createElement("div",{className:"modal show d-block",style:{background:"rgba(0,0,0,0.5)"}},React.createElement("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-fullscreen-sm-down"},React.createElement("div",{className:"modal-content",style:{borderRadius:"16px",overflow:"hidden"}},React.createElement("div",{className:"modal-header border-0 py-3",style:{background:"linear-gradient(135deg, #ffc107 0%, #ffca2c 100%)"}},React.createElement("h6",{className:"modal-title fw-bold",style:{color:"#1a1a2e"}},React.createElement("i",{className:`fas ${m?"fa-edit":"fa-plus-circle"} me-2`}),m?"S\u1EEDa s\u1EA3n ph\u1EA9m":"Th\xEAm s\u1EA3n ph\u1EA9m m\u1EDBi"),React.createElement("button",{type:"button",className:"btn-close",onClick:j})),React.createElement("form",{onSubmit:X},React.createElement("div",{className:"modal-body py-4",style:{maxHeight:"65vh",overflowY:"auto",background:"#f8f9fa"}},React.createElement("div",{className:"text-center mb-4"},React.createElement("div",{className:"position-relative d-inline-block"},d.image?React.createElement(React.Fragment,null,React.createElement("img",{src:d.image,alt:"",style:{width:110,height:110,objectFit:"cover",borderRadius:"12px",boxShadow:"0 4px 15px rgba(0,0,0,0.15)"}}),React.createElement("button",{type:"button",className:"btn btn-danger position-absolute",onClick:O,style:{top:-10,right:-10,width:28,height:28,padding:0,borderRadius:"50%",boxShadow:"0 2px 8px rgba(220,53,69,0.4)"}},React.createElement("i",{className:"fas fa-times",style:{fontSize:"0.75rem"}}))):React.createElement("div",{className:"d-flex align-items-center justify-content-center",style:{width:110,height:110,borderRadius:"12px",background:"linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%)",border:"2px dashed #adb5bd"}},React.createElement("i",{className:"fas fa-image fa-2x text-muted"}))),React.createElement("div",{className:"mt-2"},React.createElement("label",{className:"btn btn-warning btn-sm px-3",style:{borderRadius:"20px"}},React.createElement("i",{className:`fas ${p?"fa-spinner fa-spin":"fa-camera"} me-1`}),p?q||"\u0110ang x\u1EED l\xFD...":"Ch\u1ECDn \u1EA3nh",React.createElement("input",{type:"file",accept:"image/*",onChange:f,disabled:p,style:{position:"absolute",left:"-9999px",opacity:0,width:1,height:1}})),p&&q&&React.createElement("div",{className:"text-center mt-1",style:{fontSize:11,color:"#6c757d"}},q))),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label fw-semibold small text-dark mb-1"},React.createElement("i",{className:"fas fa-tag me-1 text-warning"}),"T\xEAn s\u1EA3n ph\u1EA9m *"),React.createElement("input",{type:"text",className:"form-control",value:d.name,onChange:N=>b({...d,name:N.target.value}),required:!0,placeholder:"VD: Combo Van 3 tay + 2 xylanh",style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}})),React.createElement("div",{className:"row g-2 mb-3"},React.createElement("div",{className:"col-6"},React.createElement("label",{className:"form-label fw-semibold small text-dark mb-1"},React.createElement("i",{className:"fas fa-barcode me-1 text-info"}),"M\xE3 SP"),React.createElement("input",{type:"text",className:"form-control",value:d.code,onChange:N=>b({...d,code:N.target.value}),placeholder:"KTM-01",style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}})),React.createElement("div",{className:"col-6"},React.createElement("label",{className:"form-label fw-semibold small text-dark mb-1"},React.createElement("i",{className:"fas fa-dollar-sign me-1 text-success"}),"Gi\xE1"),React.createElement("input",{type:"text",className:"form-control",value:d.price,onChange:A,placeholder:"1.950.000\u0111",inputMode:"numeric",style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}}))),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label fw-semibold small text-dark mb-1"},React.createElement("i",{className:"fas fa-folder me-1 text-primary"}),"Danh m\u1EE5c"),React.createElement("select",{className:"form-select",value:d.category,onChange:N=>b({...d,category:N.target.value}),style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}},React.createElement("option",{value:""},"Ch\u1ECDn danh m\u1EE5c"),D.map(N=>React.createElement("option",{key:N,value:N},N)))),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label fw-semibold small text-dark mb-1"},React.createElement("i",{className:"fas fa-sticky-note me-1 text-secondary"}),"Ghi ch\xFA"),React.createElement("input",{type:"text",className:"form-control",value:d.note,onChange:N=>b({...d,note:N.target.value}),placeholder:"VD: Th\xEAm d\xE2y l\xE0 2.150.000\u0111",style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"12px"}})),React.createElement("div",{className:"mb-2"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},React.createElement("i",{className:"fas fa-link me-1"}),"URL \u1EA3nh (t\xF9y ch\u1ECDn)"),React.createElement("input",{type:"url",className:"form-control",placeholder:"https://...",value:d.image,onChange:N=>b({...d,image:N.target.value}),style:{borderRadius:"10px",border:"1px solid #dee2e6",padding:"10px",fontSize:"0.9rem"}}))),React.createElement("div",{className:"modal-footer border-0 py-3",style:{background:"#fff"}},React.createElement("button",{type:"button",className:"btn btn-light px-4",onClick:j,style:{borderRadius:"10px"}},"H\u1EE7y"),React.createElement("button",{type:"submit",className:"btn btn-warning px-4 fw-semibold",disabled:C,style:{borderRadius:"10px",boxShadow:"0 4px 12px rgba(255,193,7,0.3)"}},C?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang l\u01B0u..."):React.createElement(React.Fragment,null,React.createElement("i",{className:"fas fa-check me-2"}),"L\u01B0u s\u1EA3n ph\u1EA9m"))))))):null}function VideoModal({show:y,video:m,onClose:D,onSave:j}){const[T,d]=useState({title:"",youtube_url:"",thumbnail_url:"",sort_order:0}),[b,C]=useState(!1),[E,p]=useState("");useEffect(()=>{m?(d({title:m.title||"",youtube_url:`https://www.youtube.com/watch?v=${m.youtubeId}`,thumbnail_url:m.thumb||"",sort_order:m.sortOrder||0}),p(m.thumb)):(d({title:"",youtube_url:"",thumbnail_url:"",sort_order:0}),p(""))},[m,y]);const V=L=>{const H=L.match(/(?:youtube\.com\/(?:embed\/|watch\?v=|shorts\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);return H?H[1]:null},q=L=>{d({...T,youtube_url:L});const H=V(L);H&&p(`https://img.youtube.com/vi/${H}/hqdefault.jpg`)},I=async L=>{L.preventDefault(),C(!0),await j(T),C(!1)};return y?React.createElement("div",{className:"modal show d-block",style:{background:"rgba(0,0,0,0.5)"}},React.createElement("div",{className:"modal-dialog modal-dialog-centered"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("h5",{className:"modal-title"},m?"S\u1EEDa Video":"Th\xEAm Video m\u1EDBi"),React.createElement("button",{type:"button",className:"btn-close",onClick:D})),React.createElement("form",{onSubmit:I},React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"Link YouTube *"),React.createElement("input",{type:"url",className:"form-control",value:T.youtube_url,onChange:L=>q(L.target.value),placeholder:"https://www.youtube.com/watch?v=... ho\u1EB7c shorts/...",required:!0}),React.createElement("small",{className:"text-muted"},"H\u1ED7 tr\u1EE3: youtube.com/watch, youtu.be, youtube.com/shorts")),E&&React.createElement("div",{className:"mb-3 text-center"},React.createElement("img",{src:E,alt:"Preview",className:"img-fluid rounded",style:{maxHeight:"150px"}})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"Ti\xEAu \u0111\u1EC1 *"),React.createElement("input",{type:"text",className:"form-control",value:T.title,onChange:L=>d({...T,title:L.target.value}),required:!0})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"Th\u1EE9 t\u1EF1"),React.createElement("input",{type:"number",className:"form-control",value:T.sort_order,onChange:L=>d({...T,sort_order:parseInt(L.target.value)||0})})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label"},"Thumbnail t\xF9y ch\u1EC9nh (t\xF9y ch\u1ECDn)"),React.createElement("input",{type:"url",className:"form-control",value:T.thumbnail_url,onChange:L=>d({...T,thumbnail_url:L.target.value}),placeholder:"\u0110\u1EC3 tr\u1ED1ng s\u1EBD d\xF9ng thumbnail m\u1EB7c \u0111\u1ECBnh c\u1EE7a YouTube"}))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"button",className:"btn btn-secondary",onClick:D},"H\u1EE7y"),React.createElement("button",{type:"submit",className:"btn btn-warning",disabled:b},b?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang l\u01B0u..."):"L\u01B0u")))))):null}function AdminApp(){const[y,m]=useState(!1),[D,j]=useState(""),[T,d]=useState(null),[b,C]=useState("search"),[E,p]=useState(null),[V,q]=useState(""),[I,L]=useState([]),[H,F]=useState(null),[A,$]=useState(!1),[R,Z]=useState(null),[J,f]=useState(!0),[O,X]=useState([]),[N,te]=useState(null),[P,Y]=useState([]);useEffect(()=>{const t=localStorage.getItem("ktm_admin_session");if(t)try{const n=JSON.parse(t);n.expiry>Date.now()?(m(!0),d(n.user)):localStorage.removeItem("ktm_admin_session")}catch(n){localStorage.removeItem("ktm_admin_session")}},[]),useEffect(()=>{y&&W()},[y]);const ye=async(t,n)=>{j("");try{const _=await fetch(`${API_BASE}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:n})}),B=await _.json();if(!_.ok)throw new Error(B.error||"\u0110\u0103ng nh\u1EADp th\u1EA5t b\u1EA1i");const ce={user:B.user,token:B.token,expiry:Date.now()+100*365*24*60*60*1e3};localStorage.setItem("ktm_admin_session",JSON.stringify(ce)),d(B.user),m(!0)}catch(_){j(_.message)}},ee=()=>{localStorage.removeItem("ktm_admin_session"),m(!1),d(null),L([]),F(null)},ae=(t,n="success")=>{const _=Date.now();X(B=>[...B,{id:_,message:t,type:n}])},re=t=>{X(n=>n.filter(_=>_.id!==t))},W=async(t=null)=>{f(!0);try{const n=t?`${API_BASE}/api/albums?parent_id=${t}`:`${API_BASE}/api/albums?parent_id=root`,B=await(await fetch(n)).json();L(Array.isArray(B)?B:[])}catch(n){console.error(n),ae("L\u1ED7i t\u1EA3i danh s\xE1ch album","danger")}f(!1)},he=()=>{Z(null),$(!0)},ue=t=>{Z(t),$(!0)},U=async t=>{try{const n=R&&R.uuid;!n&&N&&(t.parent_id=N.uuid);const _=n?`${API_BASE}/api/albums/${R.uuid||R.id}`:`${API_BASE}/api/albums`,B=await fetch(_,{method:n?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!B.ok){const ce=await B.json();throw new Error(ce.error||(n?"L\u1ED7i c\u1EADp nh\u1EADt":"L\u1ED7i t\u1EA1o"))}ae(n?"C\u1EADp nh\u1EADt th\xE0nh c\xF4ng!":"T\u1EA1o th\xE0nh c\xF4ng!","success"),$(!1),W(N==null?void 0:N.uuid)}catch(n){ae(n.message,"danger")}},ge=t=>{F(t)},_e=t=>{if(t==="root")Y([]),te(null),W(null);else if(t){const n=P.findIndex(_=>_.uuid===t.uuid);n>=0&&(Y(P.slice(0,n+1)),te(t),W(t.uuid))}else{const n=[...P];n.pop();const _=n[n.length-1]||null;Y(n),te(_),W(_==null?void 0:_.uuid)}},oe=async t=>{const n=`X\xF3a folder "${t.title}"? T\u1EA5t c\u1EA3 folder con v\xE0 \u1EA3nh b\xEAn trong s\u1EBD b\u1ECB x\xF3a!`;if(confirm(n))try{await fetch(`${API_BASE}/api/albums/${t.uuid||t.id}`,{method:"DELETE"}),ae("\u0110\xE3 x\xF3a","success"),W(N==null?void 0:N.uuid)}catch(_){ae("L\u1ED7i x\xF3a album","danger")}};if(!y)return React.createElement(LoginPage,{onLogin:ye,error:D});const ve=()=>{const t=new Date,n=t.getFullYear(),_=String(t.getMonth()+1).padStart(2,"0");return`${n}-${_}`};function je(){const[t,n]=useState(ve()),[_,B]=useState(!0),[ce,$e]=useState([]),we=h=>{if(!h)return 0;const le=String(h).replace(/[^0-9]/g,"");return le?Number(le):0},Ce=h=>{if(!h)return null;const le=String(h),pe=le.toLowerCase();if(pe.includes("freeship")||pe.includes("free ship")||pe.includes("mi\u1EC5n ph\xED ship")||pe.includes("mien phi ship")||pe.includes("mi\u1EC5n ph\xED v\u1EADn chuy\u1EC3n")||pe.includes("mien phi van chuyen"))return 0;const be=le.match(/(?:ship|vận\s*chuyển|van\s*chuyen|\bvc\b)\s*[:=\-]?\s*([0-9][0-9\.,\s]*)(?:\s*(k|nghìn|nghin|tr|triệu|trieu|m))?/i);if(!be)return null;const ke=String(be[1]||"").replace(/[^0-9]/g,"");if(!ke)return null;let fe=Number(ke);const Se=String(be[2]||"").toLowerCase();return Se==="k"||Se.startsWith("ngh")?fe*=1e3:(Se==="tr"||Se.startsWith("tri")||Se==="m")&&(fe*=1e6),Number.isFinite(fe)?fe:null},Ee=h=>{const le=Array.isArray(h)?h:[];let pe=!1,be=0;for(const ke of le){const fe=Ce(ke==null?void 0:ke.product_note);fe!=null&&(pe=!0,fe>be&&(be=fe))}return{found:pe,fee:be}},M=h=>{try{return Number(h||0).toLocaleString("vi-VN")}catch(le){return String(h||0)}},de=h=>`${M(h)}\u0111`,Oe=async()=>{B(!0);try{const le=await(await fetch(`${API_BASE}/api/orders?month=${encodeURIComponent(t)}`)).json();$e(Array.isArray(le)?le:[])}catch(h){console.error("Load stats error:",h),$e([])}finally{B(!1)}};useEffect(()=>{Oe()},[t]);const se=React.useMemo(()=>{const h={pending:0,processing:0,done:0,other:0};let le=0,pe=0,be=0;const ke=s=>s.customer_id||s.phone||"unknown",fe=s=>Array.isArray(s==null?void 0:s.items)&&s.items.length?s.items:s!=null&&s.product_id?[{product_id:s.product_id,quantity:s.quantity,product_price:s.product_price,product_name:s.product_name,product_code:s.product_code,product_note:s.product_note}]:[],Se=new Map,Ae=new Map,o=new Map;for(const s of ce){const u=fe(s);let e=0,r=0;for(const k of u){const K=Number((k==null?void 0:k.quantity)||0)||0,ne=we(k==null?void 0:k.product_price),ie=K*ne;e+=K,r+=ie;const Q=(k==null?void 0:k.product_id)||"unknown",Ne=Se.get(Q)||{product_id:Q,product_name:(k==null?void 0:k.product_name)||"\u2014",product_code:(k==null?void 0:k.product_code)||"",orders:0,quantity:0,revenue:0};Ne.orders+=1,Ne.quantity+=K,Ne.revenue+=ie,Se.set(Q,Ne)}const c=Ee(u),g=r+(c.found?c.fee:0);le+=e,pe+=g,s.status==="pending"?h.pending+=1:s.status==="processing"?h.processing+=1:s.status==="done"?(h.done+=1,be+=g):h.other+=1;const w=ke(s),S=Ae.get(w)||{key:w,customer_name:s.customer_name||"",phone:s.phone||"",orders:0,quantity:0,revenue:0};S.orders+=1,S.quantity+=e,S.revenue+=g,!S.customer_name&&s.customer_name&&(S.customer_name=s.customer_name),!S.phone&&s.phone&&(S.phone=s.phone),Ae.set(w,S);const v=s.created_at?new Date(s.created_at):null;if(v&&!Number.isNaN(v.getTime())){const k=`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}-${String(v.getDate()).padStart(2,"0")}`,K=o.get(k)||{day:k,orders:0,quantity:0,revenue:0,doneOrders:0,doneRevenue:0};K.orders+=1,K.quantity+=e,K.revenue+=g,s.status==="done"&&(K.doneOrders+=1,K.doneRevenue+=g),o.set(k,K)}}const x=Array.from(Se.values()).sort((s,u)=>u.revenue-s.revenue),z=Array.from(Ae.values()).sort((s,u)=>u.revenue-s.revenue),me=Array.from(o.values()).sort((s,u)=>s.day.localeCompare(u.day)),a=Ae.size,l=ce.length?Math.round(pe/ce.length):0,i=ce.length?le/ce.length:0;return{statusCounts:h,totalQty:le,totalRevenue:pe,doneRevenue:be,products:x,customers:z,days:me,uniqueCustomers:a,avgOrderValue:l,avgQtyPerOrder:i}},[ce,t]);return React.createElement("div",{className:"product-manager pb-5 mb-4 stats-manager"},React.createElement(Loading,{show:_}),React.createElement("div",{className:"product-header"},React.createElement("h5",{className:"mb-0"},React.createElement("i",{className:"fas fa-chart-column me-2 text-warning"}),"Th\u1ED1ng k\xEA"),React.createElement("button",{className:"btn btn-outline-secondary btn-sm",onClick:Oe,disabled:_},React.createElement("i",{className:"fas fa-rotate me-2"}),"L\xE0m m\u1EDBi")),React.createElement("div",{className:"product-search"},React.createElement("div",{className:"row g-2 align-items-end"},React.createElement("div",{className:"col-12 col-md-5"},React.createElement("label",{className:"form-label mb-1"},"Ch\u1ECDn th\xE1ng"),React.createElement("div",{className:"input-group"},React.createElement("span",{className:"input-group-text","aria-hidden":"true"},React.createElement("i",{className:"fas fa-calendar-alt"})),React.createElement("input",{type:"month",className:"form-control",value:t,onChange:h=>n(h.target.value),"aria-label":"Ch\u1ECDn th\xE1ng"}))),React.createElement("div",{className:"col-12 col-md-7 d-flex gap-2 justify-content-md-end"},React.createElement("div",{className:"d-flex flex-wrap gap-2 align-self-center"},React.createElement("span",{className:"badge rounded-pill bg-dark bg-opacity-10 text-dark"},React.createElement("i",{className:"fas fa-receipt me-1"}),M(ce.length)," \u0111\u01A1n"),React.createElement("span",{className:"badge rounded-pill bg-info bg-opacity-10 text-dark"},React.createElement("i",{className:"fas fa-user me-1"}),M(se.uniqueCustomers)," kh\xE1ch"),React.createElement("span",{className:"badge rounded-pill bg-warning bg-opacity-10 text-dark"},React.createElement("i",{className:"fas fa-boxes-stacked me-1"}),M(se.totalQty)," SL"))))),React.createElement("div",{className:"row g-2"},React.createElement("div",{className:"col-6 col-md-3"},React.createElement("div",{className:"card p-3 border-0 shadow-sm bg-dark bg-opacity-10"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("div",{className:"text-muted small"},"T\u1ED5ng \u0111\u01A1n"),React.createElement("i",{className:"fas fa-receipt text-dark"})),React.createElement("div",{className:"fs-4 fw-semibold text-dark"},M(ce.length)))),React.createElement("div",{className:"col-6 col-md-3"},React.createElement("div",{className:"card p-3 border-0 shadow-sm bg-warning bg-opacity-10"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("div",{className:"text-muted small"},"Doanh thu (t\u1EA1m t\xEDnh)"),React.createElement("i",{className:"fas fa-sack-dollar text-warning"})),React.createElement("div",{className:"fs-4 fw-semibold text-dark"},de(se.totalRevenue)))),React.createElement("div",{className:"col-6 col-md-3"},React.createElement("div",{className:"card p-3 border-0 shadow-sm bg-success bg-opacity-10"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("div",{className:"text-muted small"},"Doanh thu (Ho\xE0n th\xE0nh)"),React.createElement("i",{className:"fas fa-circle-check text-success"})),React.createElement("div",{className:"fs-4 fw-semibold text-dark"},de(se.doneRevenue)))),React.createElement("div",{className:"col-6 col-md-3"},React.createElement("div",{className:"card p-3 border-0 shadow-sm bg-info bg-opacity-10"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("div",{className:"text-muted small"},"Gi\xE1 tr\u1ECB TB/\u0111\u01A1n"),React.createElement("i",{className:"fas fa-chart-line text-info"})),React.createElement("div",{className:"fs-4 fw-semibold text-dark"},de(se.avgOrderValue))))),React.createElement("div",{className:"card p-3 mt-3"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("h6",{className:"mb-0"},React.createElement("i",{className:"fas fa-layer-group me-2 text-warning"}),"T\u1ED5ng quan tr\u1EA1ng th\xE1i"),React.createElement("span",{className:"badge rounded-pill bg-dark bg-opacity-10 text-dark"},"SL TB/\u0111\u01A1n: ",se.avgQtyPerOrder?se.avgQtyPerOrder.toFixed(2):"0.00")),React.createElement("div",{className:"d-md-none mt-2"},React.createElement("div",{className:"row g-2"},React.createElement("div",{className:"col-6"},React.createElement("div",{className:"card p-2 border-0 shadow-sm bg-secondary bg-opacity-10"},React.createElement("div",{className:"text-muted small"},"Ch\u1EDD x\u1EED l\xFD"),React.createElement("div",{className:"fw-semibold"},M(se.statusCounts.pending)))),React.createElement("div",{className:"col-6"},React.createElement("div",{className:"card p-2 border-0 shadow-sm bg-warning bg-opacity-10"},React.createElement("div",{className:"text-muted small"},"\u0110ang v\u1EADn chuy\u1EC3n"),React.createElement("div",{className:"fw-semibold"},M(se.statusCounts.processing)))),React.createElement("div",{className:"col-6"},React.createElement("div",{className:"card p-2 border-0 shadow-sm bg-success bg-opacity-10"},React.createElement("div",{className:"text-muted small"},"Ho\xE0n th\xE0nh"),React.createElement("div",{className:"fw-semibold"},M(se.statusCounts.done)))),React.createElement("div",{className:"col-6"},React.createElement("div",{className:"card p-2 border-0 shadow-sm bg-dark bg-opacity-10"},React.createElement("div",{className:"text-muted small"},"T\u1ED5ng SL"),React.createElement("div",{className:"fw-semibold"},M(se.totalQty)))))),React.createElement("div",{className:"d-none d-md-block table-responsive mt-2"},React.createElement("table",{className:"table table-bordered mb-0"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Ch\u1EDD x\u1EED l\xFD"),React.createElement("th",null,"\u0110ang v\u1EADn chuy\u1EC3n"),React.createElement("th",null,"Ho\xE0n th\xE0nh"),React.createElement("th",null,"Kh\xE1c"),React.createElement("th",null,"T\u1ED5ng SL"))),React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",null,M(se.statusCounts.pending)),React.createElement("td",null,M(se.statusCounts.processing)),React.createElement("td",null,M(se.statusCounts.done)),React.createElement("td",null,M(se.statusCounts.other)),React.createElement("td",null,M(se.totalQty))))))),React.createElement("div",{className:"card p-3 mt-3"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("h6",{className:"mb-0"},React.createElement("i",{className:"fas fa-box me-2 text-info"}),"Top s\u1EA3n ph\u1EA9m"),React.createElement("span",{className:"badge rounded-pill bg-info bg-opacity-10 text-dark"},"Theo doanh thu \u2022 Top 10")),React.createElement("div",{className:"d-md-none mt-2"},se.products.slice(0,10).map(h=>React.createElement("div",{key:h.product_id,className:"card mb-2 p-2 border-0 shadow-sm border-start border-4 border-info"},React.createElement("div",{className:"d-flex justify-content-between align-items-start gap-2"},React.createElement("div",{className:"fw-semibold",style:{minWidth:0,flex:1}},React.createElement("div",{className:"text-truncate"},h.product_name),React.createElement("div",{className:"text-muted small text-truncate"},h.product_code?`#${h.product_code} \u2022 `:"",M(h.orders)," \u0111\u01A1n \u2022 ",M(h.quantity)," SL")),React.createElement("div",{className:"fw-semibold text-nowrap"},de(h.revenue)))))),React.createElement("div",{className:"d-none d-md-block table-responsive mt-2"},React.createElement("table",{className:"table table-bordered mb-0"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"S\u1EA3n ph\u1EA9m"),React.createElement("th",null,"M\xE3"),React.createElement("th",null,"\u0110\u01A1n"),React.createElement("th",null,"SL"),React.createElement("th",null,"Doanh thu"))),React.createElement("tbody",null,se.products.slice(0,10).map(h=>React.createElement("tr",{key:h.product_id},React.createElement("td",null,h.product_name),React.createElement("td",null,h.product_code||"\u2014"),React.createElement("td",null,M(h.orders)),React.createElement("td",null,M(h.quantity)),React.createElement("td",{className:"fw-semibold"},de(h.revenue)))))))),React.createElement("div",{className:"card p-3 mt-3"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("h6",{className:"mb-0"},React.createElement("i",{className:"fas fa-user-group me-2 text-warning"}),"Top kh\xE1ch h\xE0ng"),React.createElement("span",{className:"badge rounded-pill bg-warning bg-opacity-10 text-dark"},"Theo doanh thu \u2022 Top 10")),React.createElement("div",{className:"d-md-none mt-2"},se.customers.slice(0,10).map(h=>React.createElement("div",{key:h.key,className:"card mb-2 p-2 border-0 shadow-sm border-start border-4 border-warning"},React.createElement("div",{className:"d-flex justify-content-between align-items-start gap-2"},React.createElement("div",{className:"fw-semibold",style:{minWidth:0,flex:1}},React.createElement("div",{className:"text-truncate"},h.customer_name||"\u2014"),React.createElement("div",{className:"text-muted small text-truncate"},h.phone||"\u2014"," \u2022 ",M(h.orders)," \u0111\u01A1n \u2022 ",M(h.quantity)," SL")),React.createElement("div",{className:"fw-semibold text-nowrap"},de(h.revenue)))))),React.createElement("div",{className:"d-none d-md-block table-responsive mt-2"},React.createElement("table",{className:"table table-bordered mb-0"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Kh\xE1ch h\xE0ng"),React.createElement("th",null,"S\u0110T"),React.createElement("th",null,"\u0110\u01A1n"),React.createElement("th",null,"SL"),React.createElement("th",null,"Doanh thu"))),React.createElement("tbody",null,se.customers.slice(0,10).map(h=>React.createElement("tr",{key:h.key},React.createElement("td",null,h.customer_name||"\u2014"),React.createElement("td",null,h.phone||"\u2014"),React.createElement("td",null,M(h.orders)),React.createElement("td",null,M(h.quantity)),React.createElement("td",{className:"fw-semibold"},de(h.revenue)))))))),React.createElement("div",{className:"card p-3 mt-3 mb-4"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("h6",{className:"mb-0"},React.createElement("i",{className:"fas fa-calendar-day me-2 text-success"}),"Theo ng\xE0y"),React.createElement("span",{className:"badge rounded-pill bg-success bg-opacity-10 text-dark"},"DT (t\u1EA1m t\xEDnh) & ho\xE0n th\xE0nh")),React.createElement("div",{className:"d-md-none mt-2"},se.days.map(h=>React.createElement("div",{key:h.day,className:"card mb-2 p-2 border-0 shadow-sm border-start border-4 border-success"},React.createElement("div",{className:"d-flex justify-content-between align-items-start gap-2"},React.createElement("div",{style:{minWidth:0,flex:1}},React.createElement("div",{className:"fw-semibold"},h.day),React.createElement("div",{className:"text-muted small"},M(h.orders)," \u0111\u01A1n \u2022 ",M(h.quantity)," SL"),React.createElement("div",{className:"text-muted small"},"Ho\xE0n th\xE0nh: ",M(h.doneOrders)," \u2022 ",de(h.doneRevenue))),React.createElement("div",{className:"fw-semibold text-nowrap"},de(h.revenue)))))),React.createElement("div",{className:"d-none d-md-block table-responsive mt-2"},React.createElement("table",{className:"table table-bordered mb-0"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Ng\xE0y"),React.createElement("th",null,"\u0110\u01A1n"),React.createElement("th",null,"SL"),React.createElement("th",null,"DT (t\u1EA1m t\xEDnh)"),React.createElement("th",null,"\u0110\u01A1n ho\xE0n th\xE0nh"),React.createElement("th",null,"DT ho\xE0n th\xE0nh"))),React.createElement("tbody",null,se.days.map(h=>React.createElement("tr",{key:h.day},React.createElement("td",null,h.day),React.createElement("td",null,M(h.orders)),React.createElement("td",null,M(h.quantity)),React.createElement("td",{className:"fw-semibold"},de(h.revenue)),React.createElement("td",null,M(h.doneOrders)),React.createElement("td",{className:"fw-semibold"},de(h.doneRevenue)))))))))}return React.createElement("div",null,React.createElement(Sidebar,{activeMenu:b,onMenuChange:t=>{C(t),t==="albums"&&(te(null),Y([]),W(null))},onLogout:ee,currentUser:T}),React.createElement("div",{className:"main-content"},b==="albums"&&!H&&React.createElement(AlbumList,{albums:I,loading:J,currentFolder:N,breadcrumb:P,onSelect:ge,onCreate:he,onEdit:ue,onDelete:oe,onBack:_e}),b==="search"&&React.createElement(SearchCenter,{showToast:ae,onNavigate:(t,n,_)=>{C(t),t==="orders"&&n==="create"&&(p(Date.now()),q((_==null?void 0:_.productId)||""))}}),b==="albums"&&H&&React.createElement(AlbumDetail,{album:H,parentAlbum:P.length>0?P[P.length-1]:null,onBack:()=>{if(H.parentId){const t=P.findIndex(n=>n.uuid===H.parentId);t>=0?F(P[t]):F(null)}else F(null)},onRefresh:()=>W(N==null?void 0:N.uuid),showToast:ae,onNavigateToFolder:t=>{Y(n=>[...n,H]),F(t)},onEditSubfolder:t=>{Z(t),$(!0)}}),b==="videos"&&React.createElement(VideoList,{showToast:ae}),b==="products"&&React.createElement(ProductManager,{showToast:ae}),b==="orders"&&React.createElement(OrderManager,{autoOpenCreateToken:E,autoOpenCreateProductId:V,showToast:ae}),b==="stats"&&React.createElement(je,null)),React.createElement("nav",{className:"mobile-bottom-nav"},React.createElement("div",{className:"nav-items"},React.createElement("a",{href:"#",className:`nav-item ${b==="search"?"active":""}`,onClick:t=>{t.preventDefault(),C("search")}},React.createElement("i",{className:"fas fa-search"}),React.createElement("span",null,"Tra c\u1EE9u")),React.createElement("a",{href:"#",className:`nav-item ${b==="albums"?"active":""}`,onClick:t=>{t.preventDefault(),C("albums"),F(null)}},React.createElement("i",{className:"fas fa-images"}),React.createElement("span",null,"Album")),React.createElement("a",{href:"#",className:`nav-item ${b==="videos"?"active":""}`,onClick:t=>{t.preventDefault(),C("videos")}},React.createElement("i",{className:"fas fa-video"}),React.createElement("span",null,"Video")),React.createElement("a",{href:"#",className:`nav-item ${b==="products"?"active":""}`,onClick:t=>{t.preventDefault(),C("products")}},React.createElement("i",{className:"fas fa-box"}),React.createElement("span",null,"S\u1EA3n ph\u1EA9m")),React.createElement("a",{href:"#",className:`nav-item ${b==="orders"?"active":""}`,onClick:t=>{t.preventDefault(),C("orders")}},React.createElement("i",{className:"fas fa-receipt"}),React.createElement("span",null,"\u0110\u01A1n h\xE0ng")),React.createElement("a",{href:"#",className:`nav-item ${b==="stats"?"active":""}`,onClick:t=>{t.preventDefault(),C("stats")}},React.createElement("i",{className:"fas fa-chart-column"}),React.createElement("span",null,"Th\u1ED1ng k\xEA")))),React.createElement(AlbumModal,{show:A,album:R,parentId:N==null?void 0:N.uuid,onClose:()=>$(!1),onSave:U}),React.createElement("div",{className:"toast-container"},O.map(t=>React.createElement(Toast,{key:t.id,message:t.message,type:t.type,onClose:()=>re(t.id)}))))}ReactDOM.render(React.createElement(AdminApp,null),document.getElementById("root"));function OrderManager({autoOpenCreateToken:y,autoOpenCreateProductId:m,showToast:D}){const[j,T]=useState([]),[d,b]=useState(!0),[C,E]=useState(!1),[p,V]=useState(null),[q,I]=useState(""),[L,H]=useState(!1),[F,A]=useState(null),[$,R]=useState({customer_name:"",phone:"",address:"",items:[{product_id:"",quantity:1}],status:"pending"}),[Z,J]=useState([""]),[f,O]=useState(null),X=useRef({}),[N,te]=useState([]),[P,Y]=useState(null),ye=useRef(null),ee=useRef(null),ae=useRef(0),re=useRef(null),W=useRef(0),he=3;useEffect(()=>{const a=l=>{var s;if(f==null)return;const i=(s=X.current)==null?void 0:s[f];i&&!i.contains(l.target)&&O(null)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[f]);const ue=a=>{if(a==null)return 0;const l=String(a).replace(/[^0-9]/g,"");return l?Number(l):0},U=a=>{try{return`${Number(a||0).toLocaleString("vi-VN")}\u0111`}catch(l){return`${a||0}\u0111`}},ge=a=>{if(!a)return null;const l=String(a),i=l.toLowerCase();if(i.includes("freeship")||i.includes("free ship")||i.includes("mi\u1EC5n ph\xED ship")||i.includes("mien phi ship")||i.includes("mi\u1EC5n ph\xED v\u1EADn chuy\u1EC3n")||i.includes("mien phi van chuyen"))return 0;const s=l.match(/(?:ship|vận\s*chuyển|van\s*chuyen|\bvc\b)\s*[:=\-]?\s*([0-9][0-9\.,\s]*)(?:\s*(k|nghìn|nghin|tr|triệu|trieu|m))?/i);if(!s)return null;const u=String(s[1]||"").replace(/[^0-9]/g,"");if(!u)return null;let e=Number(u);const r=String(s[2]||"").toLowerCase();return r==="k"||r.startsWith("ngh")?e*=1e3:(r==="tr"||r.startsWith("tri")||r==="m")&&(e*=1e6),Number.isFinite(e)?e:null},_e=a=>{const l=oe(a);return l.length>=9&&l.length<=12},oe=a=>a?String(a).replace(/[^0-9]/g,""):"",ve=async a=>{const l=oe(a);if(!l)return;const i=++ae.current;A({status:"loading",phone:l});try{const u=await(await fetch(`${API_BASE}/api/customers?phone=${encodeURIComponent(l)}`)).json();if(ae.current!==i)return;if(u&&u.exists&&u.customer){A({status:"found",phone:l,customer:u.customer}),R(e=>oe(e.phone)!==l?e:{...e,customer_name:u.customer.name||e.customer_name,address:u.customer.address||e.address});return}A({status:"not-found",phone:l})}catch(s){if(ae.current!==i)return;console.error("Customer lookup error:",s),A({status:"error",phone:l})}},je=a=>{const l=oe(a);if(R(s=>({...s,phone:l})),ee.current&&(clearTimeout(ee.current),ee.current=null),l.length<he){A(null);return}ee.current=setTimeout(()=>{ve(l)},350)},t=()=>{const a=oe($.phone);a.length<he||ve(a)};useEffect(()=>(L?(document.body.classList.add("order-modal-open"),document.body.style.overflow="hidden"):(document.body.classList.remove("order-modal-open"),document.body.style.overflow=""),()=>{document.body.classList.remove("order-modal-open"),document.body.style.overflow=""}),[L]);const n=Array.isArray($.items)?$.items.length:0;useEffect(()=>{if(!L){W.current=n;return}n>W.current&&setTimeout(()=>{const a=re.current;a&&a.scrollTo({top:a.scrollHeight,behavior:"smooth"})},0),W.current=n},[L,n]),useEffect(()=>()=>{ee.current&&(clearTimeout(ee.current),ee.current=null)},[]),useEffect(()=>{we()},[]),useEffect(()=>{Ce()},[q]),useEffect(()=>{y&&ye.current!==y&&(ye.current=y,de(m))},[y]);const _=a=>a==="pending"?"Ch\u1EDD x\u1EED l\xFD":a==="processing"?"\u0110ang v\u1EADn chuy\u1EC3n":a==="done"?"Ho\xE0n th\xE0nh":a||"",B=a=>a==="pending"?"bg-secondary":a==="processing"?"bg-warning text-dark":a==="done"?"bg-success":"bg-light text-dark",ce=React.useMemo(()=>{const a={pending:0,processing:1,done:2},l=s=>s in a?a[s]:99,i=s=>{if(!s)return Number.POSITIVE_INFINITY;const u=new Date(s).getTime();return Number.isFinite(u)?u:Number.POSITIVE_INFINITY};return[...j||[]].sort((s,u)=>{const e=l(s==null?void 0:s.status),r=l(u==null?void 0:u.status);if(e!==r)return e-r;const c=i(s==null?void 0:s.created_at),g=i(u==null?void 0:u.created_at);if(c!==g)return c-g;const w=Number(s==null?void 0:s.id),S=Number(u==null?void 0:u.id);return Number.isFinite(w)&&Number.isFinite(S)?w-S:String((s==null?void 0:s.id)||"").localeCompare(String((u==null?void 0:u.id)||""))})},[j]),$e=a=>{if(!a)return"";const l=new Date(a);if(Number.isNaN(l.getTime()))return String(a);try{return l.toLocaleString("vi-VN")}catch(i){return l.toISOString()}},we=async()=>{try{const l=await(await fetch(`${API_BASE}/api/products`)).json();te(Array.isArray(l)?l:[])}catch(a){console.error("Load products error:",a),te([])}},Ce=async()=>{b(!0);try{let a=`${API_BASE}/api/orders`;q&&(a+=`?month=${q}`);const i=await(await fetch(a)).json();T(Array.isArray(i)?i:[])}catch(a){console.error("Load orders error:",a),T([])}finally{b(!1)}},Ee=async()=>{const a=oe($.phone),i=(Array.isArray($.items)?$.items:[]).map(s=>{var u;return{product_id:(s==null?void 0:s.product_id)||"",quantity:Number((u=s==null?void 0:s.quantity)!=null?u:1)}}).filter(s=>s.product_id&&Number.isFinite(s.quantity)&&s.quantity>0);if(!$.customer_name||!a||i.length===0){alert("Thi\u1EBFu d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c");return}if(!_e(a)){alert("S\u1ED1 \u0111i\u1EC7n tho\u1EA1i kh\xF4ng h\u1EE3p l\u1EC7 (c\u1EA7n 9-12 ch\u1EEF s\u1ED1)");return}E(!0);try{const s=P?"PUT":"POST",u=P?`${API_BASE}/api/orders/${P}`:`${API_BASE}/api/orders`,e=i[0];await fetch(u,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_name:$.customer_name,phone:a,address:$.address,product_id:e.product_id,quantity:e.quantity,status:$.status,items:i,...P?{id:P}:{}})}),R({customer_name:"",phone:"",address:"",items:[{product_id:"",quantity:1}],status:"pending"}),Y(null),H(!1),Ce()}finally{E(!1)}},M=a=>{Y(a.id);const l=Array.isArray(a.items)&&a.items.length?a.items.map(i=>{var s;return{product_id:(i==null?void 0:i.product_id)||"",quantity:Number((s=i==null?void 0:i.quantity)!=null?s:1)||1}}).filter(i=>i.product_id):[{product_id:a.product_id||"",quantity:Number(a.quantity||1)||1}];R({customer_name:a.customer_name||"",phone:oe(a.phone||""),address:a.address||"",items:l.length?l:[{product_id:"",quantity:1}],status:a.status||"pending"}),J(new Array(l.length?l.length:1).fill("")),A(null),H(!0),a.phone&&ve(oe(a.phone))};function de(a){Y(null),R({customer_name:"",phone:"",address:"",items:[{product_id:a||"",quantity:1}],status:"pending"}),J([""]),A(null),H(!0)}const Oe=()=>{C||(H(!1),Y(null),R({customer_name:"",phone:"",address:"",items:[{product_id:"",quantity:1}],status:"pending"}),J([""]),O(null),A(null))},se=a=>{if(!a)return"-- ch\u1ECDn s\u1EA3n ph\u1EA9m --";const l=String(a),i=N.find(s=>String(s==null?void 0:s.id)===l);return i?`${i.name}${i.code?` (${i.code})`:""}`:"-- ch\u1ECDn s\u1EA3n ph\u1EA9m --"},h=a=>{const l=String(Z[a]||"").trim().toLowerCase();return l?N.filter(i=>{const s=String((i==null?void 0:i.name)||"").toLowerCase(),u=String((i==null?void 0:i.code)||"").toLowerCase();return s.includes(l)||u.includes(l)}):N},le=a=>Array.isArray(a==null?void 0:a.items)&&a.items.length?a.items:a!=null&&a.product_id?[{product_id:a.product_id,quantity:Number(a.quantity||1)||1,product_name:a.product_name}]:[],pe=a=>{var u,e;const i=le(a).reduce((r,c)=>r+(Number((c==null?void 0:c.quantity)||0)||0),0);if(i>0)return i;const s=Number((e=(u=a==null?void 0:a.total_quantity)!=null?u:a==null?void 0:a.quantity)!=null?e:0);return Number.isFinite(s)?s:0},be=a=>{const l=le(a);if(!l.length)return"\u2014";const i=l.map(s=>{const u=s==null?void 0:s.product_name;if(u)return String(u);const e=String((s==null?void 0:s.product_id)||""),r=N.find(c=>String(c==null?void 0:c.id)===e);return r!=null&&r.name?String(r.name):""}).filter(Boolean);return i.length?i.join(" + "):(a==null?void 0:a.product_name)||"\u2014"},ke=a=>{const l=le(a);return l.length?l.map(i=>{var g;const s=i==null?void 0:i.product_name,u=String((i==null?void 0:i.product_id)||""),e=N.find(w=>String(w==null?void 0:w.id)===u),r=(s||(e==null?void 0:e.name)||"").toString().trim(),c=Number((g=i==null?void 0:i.quantity)!=null?g:1)||1;return{name:r,qty:c}}).filter(i=>i.name):[]},fe=a=>{var g;const l=le(a),i=ke(a),s=x(l),u=o(l),e=u.fee,r=s+e,c=[];if(c.push(`\u0110\u01A0N H\xC0NG #${(g=a==null?void 0:a.id)!=null?g:""}`.trim()),a!=null&&a.customer_name&&c.push(`Kh\xE1ch: ${a.customer_name}`),a!=null&&a.phone&&c.push(`S\u0110T: ${a.phone}`),a!=null&&a.address&&c.push(`\u0110\u1ECBa ch\u1EC9: ${a.address}`),a!=null&&a.status&&c.push(`Tr\u1EA1ng th\xE1i: ${_(a.status)}`),a!=null&&a.created_at&&c.push(`Th\u1EDDi gian: ${$e(a.created_at)}`),c.push(""),c.push("S\u1EA3n ph\u1EA9m:"),i.length)for(const w of i)c.push(`- ${w.name} x${w.qty}`);else{const w=be(a);w&&w!=="\u2014"&&c.push(`- ${w}`)}return c.push(""),c.push(`T\u1EA1m t\xEDnh: ${U(s)}`),c.push(`Ship: ${U(u.found?e:0)}`),c.push(`T\u1ED5ng: ${U(r)}`),c.filter(Boolean).join(`
`)},Se=async a=>{var s;if((s=navigator==null?void 0:navigator.clipboard)!=null&&s.writeText){await navigator.clipboard.writeText(a);return}const l=document.createElement("textarea");l.value=a,l.setAttribute("readonly",""),l.style.position="fixed",l.style.left="-9999px",document.body.appendChild(l),l.select();const i=document.execCommand("copy");if(document.body.removeChild(l),!i)throw new Error("copy_failed")},Ae=async a=>{try{const l=fe(a);await Se(l),typeof D=="function"?D("\u0110\xE3 copy th\xF4ng tin \u0111\u01A1n h\xE0ng","success"):alert("\u0110\xE3 copy th\xF4ng tin \u0111\u01A1n h\xE0ng")}catch(l){console.error(l),typeof D=="function"?D("Copy th\u1EA5t b\u1EA1i (tr\xECnh duy\u1EC7t ch\u1EB7n clipboard)","danger"):alert("Copy th\u1EA5t b\u1EA1i (tr\xECnh duy\u1EC7t ch\u1EB7n clipboard)")}},o=a=>{var u,e;const l=Array.isArray(a)?a:[];let i=!1,s=0;for(const r of l){const c=String((r==null?void 0:r.product_id)||""),g=N.find(v=>String(v==null?void 0:v.id)===c),w=(e=(u=r==null?void 0:r.product_note)!=null?u:g==null?void 0:g.note)!=null?e:null,S=ge(w);S!=null&&(i=!0,S>s&&(s=S))}return{found:i,fee:s}},x=a=>(Array.isArray(a)?a:[]).reduce((i,s)=>{var g;const u=Number((s==null?void 0:s.quantity)||0)||0,e=String((s==null?void 0:s.product_id)||""),r=N.find(w=>String(w==null?void 0:w.id)===e),c=ue((g=s==null?void 0:s.product_price)!=null?g:r==null?void 0:r.price);return i+u*c},0),z=a=>{const l=le(a),i=x(l),s=o(l).fee;return i+s},me=async a=>{if(confirm("X\xF3a \u0111\u01A1n h\xE0ng n\xE0y?")){V(a);try{await fetch(`${API_BASE}/api/orders/${a}`,{method:"DELETE"}),Ce()}finally{V(null)}}};return React.createElement("div",{className:"product-manager"},React.createElement(Loading,{show:d&&!L||C||!!p}),React.createElement("div",{className:"product-header"},React.createElement("h5",null,"Qu\u1EA3n l\xFD \u0111\u01A1n h\xE0ng"),React.createElement("button",{className:"btn btn-dark btn-sm",onClick:de,disabled:C||!!p},React.createElement("i",{className:"fas fa-plus me-2"}),"T\u1EA1o \u0111\u01A1n")),React.createElement("div",{className:"product-search"},React.createElement("div",{className:"row g-2 align-items-end"},React.createElement("div",{className:"col-12 col-md-5"},React.createElement("label",{className:"form-label mb-1"},"L\u1ECDc theo th\xE1ng"),React.createElement("div",{className:"input-group"},React.createElement("span",{className:"input-group-text","aria-hidden":"true"},React.createElement("i",{className:"fas fa-calendar-alt"})),React.createElement("input",{type:"month",className:"form-control",value:q,onChange:a=>I(a.target.value),"aria-label":"Ch\u1ECDn th\xE1ng"}),q&&React.createElement("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>{I("")},title:"B\u1ECF l\u1ECDc","aria-label":"B\u1ECF l\u1ECDc",disabled:d},React.createElement("i",{className:"fas fa-times"})))),React.createElement("div",{className:"col-12 col-md-7 d-flex gap-2 justify-content-md-end"},React.createElement("button",{className:"btn btn-outline-secondary",onClick:Ce,disabled:d},React.createElement("i",{className:"fas fa-rotate me-2"}),"L\xE0m m\u1EDBi")))),React.createElement("div",{className:"card p-3"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("h6",{className:"mb-0"},"Danh s\xE1ch \u0111\u01A1n h\xE0ng"),React.createElement("span",{className:"text-muted small"},j.length," \u0111\u01A1n")),d?React.createElement("div",{className:"text-center py-4"},React.createElement("div",{className:"spinner-border text-warning"})):j.length===0?React.createElement("div",{className:"text-center py-4 text-muted"},"Ch\u01B0a c\xF3 \u0111\u01A1n h\xE0ng"):React.createElement(React.Fragment,null,React.createElement("div",{className:"d-md-none mt-3"},ce.map(a=>React.createElement("div",{key:a.id,className:"card mb-2"},React.createElement("div",{className:"card-body p-3"},React.createElement("div",{className:"d-flex justify-content-between align-items-start gap-2"},React.createElement("div",{className:"flex-grow-1",style:{minWidth:0}},React.createElement("div",{className:"fw-semibold text-truncate"},a.customer_name),React.createElement("div",{className:"text-muted small"},a.phone),a.address&&React.createElement("div",{className:"text-muted small",style:{whiteSpace:"normal",wordBreak:"break-word"}},a.address)),React.createElement("span",{className:`badge ${B(a.status)}`},_(a.status))),React.createElement("div",{className:"mt-2 small"},React.createElement("div",null,React.createElement("div",{className:"text-muted"},"S\u1EA3n ph\u1EA9m:"),(()=>{const l=ke(a);return l.length?React.createElement("div",{className:"mt-1"},l.map((i,s)=>React.createElement("div",{key:s,className:"d-flex justify-content-between gap-2",style:{lineHeight:1.25}},React.createElement("div",{className:"fw-semibold",style:{minWidth:0,whiteSpace:"normal",wordBreak:"break-word",flex:1}},i.name),React.createElement("div",{className:"text-muted",style:{flexShrink:0}},"x",i.qty)))):React.createElement("div",{className:"fw-semibold",style:{whiteSpace:"normal",wordBreak:"break-word"}},be(a))})()),React.createElement("div",null,React.createElement("span",{className:"text-muted"},"S\u1ED1 l\u01B0\u1EE3ng:")," ",React.createElement("span",{className:"fw-semibold"},pe(a))),React.createElement("div",null,React.createElement("span",{className:"text-muted"},"T\u1ED5ng ti\u1EC1n:")," ",React.createElement("span",{className:"fw-semibold"},U(z(a)))),React.createElement("div",null,React.createElement("span",{className:"text-muted"},"Th\u1EDDi gian:")," ",$e(a.created_at))),React.createElement("div",{className:"mt-3 d-flex gap-2"},React.createElement("button",{className:"btn btn-sm btn-primary flex-fill",onClick:()=>M(a),disabled:C||!!p},"S\u1EEDa"),React.createElement("button",{className:"btn btn-sm btn-outline-secondary flex-fill",onClick:()=>Ae(a),disabled:C||!!p},React.createElement("i",{className:"fas fa-copy me-1"}),"Copy"),React.createElement("button",{className:"btn btn-sm btn-danger flex-fill",onClick:()=>me(a.id),disabled:C||p===a.id},p===a.id?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang x\xF3a"):"X\xF3a")))))),React.createElement("div",{className:"d-none d-md-block"},React.createElement("table",{className:"table table-bordered mt-3"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Kh\xE1ch h\xE0ng"),React.createElement("th",null,"S\u0110T"),React.createElement("th",null,"S\u1EA3n ph\u1EA9m"),React.createElement("th",null,"SL"),React.createElement("th",null,"T\u1ED5ng ti\u1EC1n"),React.createElement("th",null,"Tr\u1EA1ng th\xE1i"),React.createElement("th",null,"Th\u1EDDi gian"),React.createElement("th",null))),React.createElement("tbody",null,ce.map(a=>React.createElement("tr",{key:a.id},React.createElement("td",null,a.customer_name),React.createElement("td",null,a.phone),React.createElement("td",null,be(a)),React.createElement("td",null,pe(a)),React.createElement("td",{className:"fw-semibold"},U(z(a))),React.createElement("td",null,React.createElement("span",{className:`badge ${B(a.status)}`},_(a.status))),React.createElement("td",null,$e(a.created_at)),React.createElement("td",null,React.createElement("button",{className:"btn btn-sm btn-primary me-1",onClick:()=>M(a),disabled:C||!!p},"S\u1EEDa"),React.createElement("button",{className:"btn btn-sm btn-outline-secondary me-1",onClick:()=>Ae(a),disabled:C||!!p},React.createElement("i",{className:"fas fa-copy"})),React.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>me(a.id),disabled:C||p===a.id},p===a.id?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang x\xF3a"):"X\xF3a"))))))))),L&&React.createElement("div",{className:"modal show d-block order-modal",style:{background:"rgba(0,0,0,0.6)"},role:"dialog","aria-modal":"true"},React.createElement("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},React.createElement("div",{className:"modal-content",style:{borderRadius:16}},React.createElement("div",{className:"modal-header",style:{background:"linear-gradient(135deg, #ffc107, #ffca2c)",border:"none",borderRadius:"16px 16px 0 0"}},React.createElement("h5",{className:"modal-title fw-bold text-dark mb-0"},React.createElement("i",{className:"fas fa-receipt me-2"}),P?"S\u1EEDa \u0111\u01A1n h\xE0ng":"T\u1EA1o \u0111\u01A1n h\xE0ng"),React.createElement("button",{type:"button",className:"btn-close",onClick:Oe})),React.createElement("form",{onSubmit:a=>{a.preventDefault(),Ee()}},React.createElement("div",{className:"modal-body",ref:re},React.createElement("div",{className:"row g-3"},React.createElement("div",{className:"col-12"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},"T\xEAn kh\xE1ch h\xE0ng *"),React.createElement("input",{className:"form-control",value:$.customer_name,onChange:a=>R({...$,customer_name:a.target.value}),placeholder:"Nh\u1EADp t\xEAn kh\xE1ch h\xE0ng",required:!0,style:{borderRadius:10,padding:12}})),React.createElement("div",{className:"col-12 col-md-6"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i *"),React.createElement("input",{className:"form-control",type:"tel",inputMode:"numeric",pattern:"[0-9+\\s-]*",value:$.phone,onChange:a=>je(a.target.value),onBlur:t,placeholder:"Nh\u1EADp s\u1ED1 \u0111i\u1EC7n tho\u1EA1i",required:!0,style:{borderRadius:10,padding:12}}),(F==null?void 0:F.status)==="loading"&&React.createElement("div",{className:"form-text"},"\u0110ang t\xECm kh\xE1ch theo S\u0110T..."),(F==null?void 0:F.status)==="found"&&React.createElement("div",{className:"form-text text-success"},"\u0110\xE3 c\xF3 kh\xE1ch, t\u1EF1 \u0111\u1ED9ng \u0111i\u1EC1n th\xF4ng tin."),(F==null?void 0:F.status)==="not-found"&&React.createElement("div",{className:"form-text text-muted"},"Ch\u01B0a c\xF3 kh\xE1ch, s\u1EBD t\u1EA1o m\u1EDBi khi l\u01B0u \u0111\u01A1n."),(F==null?void 0:F.status)==="error"&&React.createElement("div",{className:"form-text text-danger"},"Kh\xF4ng tra \u0111\u01B0\u1EE3c kh\xE1ch (l\u1ED7i m\u1EA1ng/server).")),React.createElement("div",{className:"col-12 col-md-6"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},"Tr\u1EA1ng th\xE1i"),React.createElement("select",{className:"form-select",value:$.status,onChange:a=>R({...$,status:a.target.value}),style:{borderRadius:10,padding:12}},React.createElement("option",{value:"pending"},"Ch\u1EDD x\u1EED l\xFD"),React.createElement("option",{value:"processing"},"\u0110ang v\u1EADn chuy\u1EC3n"),React.createElement("option",{value:"done"},"Ho\xE0n th\xE0nh"))),React.createElement("div",{className:"col-12"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},"\u0110\u1ECBa ch\u1EC9"),React.createElement("input",{className:"form-control",value:$.address,onChange:a=>R({...$,address:a.target.value}),placeholder:"Nh\u1EADp \u0111\u1ECBa ch\u1EC9 (kh\xF4ng b\u1EAFt bu\u1ED9c)",style:{borderRadius:10,padding:12}})),React.createElement("div",{className:"col-12 col-md-8"},React.createElement("div",{className:"d-flex align-items-center justify-content-between"},React.createElement("label",{className:"form-label fw-semibold small text-muted mb-1"},"S\u1EA3n ph\u1EA9m *"),React.createElement("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{R(a=>({...a,items:[...Array.isArray(a.items)?a.items:[],{product_id:"",quantity:1}]})),J(a=>[...Array.isArray(a)?a:[],""])},disabled:C},React.createElement("i",{className:"fas fa-plus me-2"}),"Th\xEAm s\u1EA3n ph\u1EA9m")),React.createElement("div",{className:"d-grid gap-2"},(Array.isArray($.items)?$.items:[{product_id:"",quantity:1}]).map((a,l)=>React.createElement("div",{key:l,className:"row g-2 align-items-end"},React.createElement("div",{className:"col-12 col-md-8"},React.createElement("div",{className:"dropdown w-100",ref:i=>{X.current[l]=i}},React.createElement("button",{type:"button",className:"form-control text-start d-flex align-items-center justify-content-between",style:{borderRadius:10,padding:12},onClick:()=>{O(i=>i===l?null:l),setTimeout(()=>{const i=document.getElementById(`order-product-search-${l}`);i&&i.focus()},0)}},React.createElement("span",{className:a.product_id?"":"text-muted",style:{minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},se(a.product_id)),React.createElement("i",{className:"fas fa-chevron-down text-muted",style:{marginLeft:8,flexShrink:0}})),f===l&&React.createElement("div",{className:"dropdown-menu show w-100 p-2",style:{maxHeight:320,overflowY:"auto"}},React.createElement("input",{id:`order-product-search-${l}`,className:"form-control",value:Z[l]||"",onChange:i=>{const s=i.target.value;J(u=>{const e=Array.isArray(u)?[...u]:[];return e[l]=s,e})},placeholder:"T\xECm theo t\xEAn / m\xE3...",style:{borderRadius:10,padding:10}}),React.createElement("div",{className:"mt-2"}),h(l).length===0?React.createElement("div",{className:"text-muted small px-2 py-1"},"Kh\xF4ng c\xF3 s\u1EA3n ph\u1EA9m ph\xF9 h\u1EE3p"):h(l).map(i=>React.createElement("button",{key:i.id,type:"button",className:"dropdown-item",onClick:()=>{const s=String(i.id);R(u=>{const e=Array.isArray(u.items)?[...u.items]:[];return e[l]={...e[l]||{quantity:1},product_id:s},{...u,items:e}}),O(null)}},i.name,i.code?` (${i.code})`:""))),React.createElement("select",{className:"form-select",value:a.product_id,onChange:()=>{},required:!0,style:{position:"absolute",opacity:0,height:0,pointerEvents:"none"},tabIndex:-1,"aria-hidden":"true"},React.createElement("option",{value:""},"-- ch\u1ECDn s\u1EA3n ph\u1EA9m --"),N.map(i=>React.createElement("option",{key:i.id,value:i.id},i.name))))),React.createElement("div",{className:"col-8 col-md-3"},React.createElement("input",{type:"number",className:"form-control",value:a.quantity,onChange:i=>{const s=i.target.value;R(u=>{const e=Array.isArray(u.items)?[...u.items]:[];return e[l]={...e[l]||{product_id:""},quantity:s},{...u,items:e}})},min:"1",style:{borderRadius:10,padding:12}})),React.createElement("div",{className:"col-4 col-md-1 d-flex justify-content-end"},React.createElement("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>{R(i=>{const s=Array.isArray(i.items)?[...i.items]:[];return s.splice(l,1),{...i,items:s.length?s:[{product_id:"",quantity:1}]}}),J(i=>{const s=Array.isArray(i)?[...i]:[];return s.splice(l,1),s.length?s:[""]}),O(i=>i==null?i:i===l?null:i>l?i-1:i)},disabled:C||(Array.isArray($.items)?$.items.length:1)<=1,title:"X\xF3a s\u1EA3n ph\u1EA9m",style:{borderRadius:10,padding:10}},React.createElement("i",{className:"fas fa-trash"}))))))),(()=>{const l=(Array.isArray($.items)?$.items:[]).filter(e=>e==null?void 0:e.product_id),i=x(l),s=o(l),u=i+(s.found?s.fee:0);return React.createElement("div",{className:"col-12"},React.createElement("div",{className:"d-flex flex-column gap-1 small bg-light rounded-3 p-3"},React.createElement("div",{className:"d-flex justify-content-between"},React.createElement("span",{className:"text-muted"},"T\u1EA1m t\xEDnh"),React.createElement("span",{className:"fw-semibold"},U(i))),s.found&&React.createElement("div",{className:"d-flex justify-content-between"},React.createElement("span",{className:"text-muted"},"Ship"),React.createElement("span",{className:"fw-semibold"},U(s.fee))),React.createElement("div",{className:"d-flex justify-content-between pt-1 border-top"},React.createElement("span",{className:"text-muted"},"T\u1ED5ng"),React.createElement("span",{className:"fw-bold"},U(u)))))})())),React.createElement("div",{className:"modal-footer",style:{border:"none"}},React.createElement("button",{type:"button",className:"btn btn-light",onClick:Oe,disabled:C,style:{borderRadius:10}},"H\u1EE7y"),React.createElement("button",{type:"submit",className:"btn btn-warning fw-semibold",disabled:C,style:{borderRadius:10,boxShadow:"0 4px 12px rgba(255,193,7,0.3)"}},C?React.createElement(React.Fragment,null,React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang l\u01B0u..."):React.createElement(React.Fragment,null,React.createElement("i",{className:"fas fa-check me-2"}),"L\u01B0u"))))))))}

